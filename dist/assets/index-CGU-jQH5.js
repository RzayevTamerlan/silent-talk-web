import{c as fr,r as i,t as ae,n as Je,f as H,C as Ae,b as U,s as ut,ab as mr,Z as pr,a6 as hr,a1 as gr,a0 as uo,o as lt,h as Rn,p as fo,H as Be,I as vr,a as hn,a2 as _n,j as yr,a9 as br,R as Le,q as _t,ac as Nn,x as Re,$ as xr,Y as le,z as pe,ad as wr,B as Cr,E as Xe,_ as Nt,F as mo,ae as Sr,af as po,ag as Er,d as ho,A as qe,ah as $r,ai as Mn,aj as Or,ak as Ir,al as Tr,Q as Rr,P as _r,L as b,am as Nr,an as Mr,V as je,O as Pr,ao as Br,ap as kr}from"./index-DrB1f3qb.js";import{d as Ye,e as Ge,i as Pn,g as Ar,D as jr,f as Lr,h as zr,j as go,c as Dr,L as vo}from"./index-oiK5t4sE.js";import{I as de,aC as Hr,aD as Fr,Z as De,aE as Vr,v as dt,af as Ur,T as Mt,C as Wr,aj as qr,ah as Et,m as gn,aF as Xr,b as Pt,aG as Yr,a as Bt,ae as Gr,ai as vn,am as Kr,aH as Zr,aI as Qr,aJ as Jr,aK as ei,aL as ti,n as ni,q as oi,o as ri,t as Ke,aM as ii,ag as si,z as ai,aN as li,aO as ci,S as ui,B as xe,aP as di,K as ct,R as fi,g as $t,u as yo,aQ as mi,aR as pi,at as hi,l as gi,a1 as Bn,a2 as kn,a3 as An,ab as Se,a7 as kt,aa as Ze,a4 as yn,aS as vi,aT as yi,a6 as bn,aU as bo,a8 as xo,a9 as wo}from"./d-func-GISHHfXS.js";var bi=function(e){if(fr()&&window.document.documentElement){var n=Array.isArray(e)?e:[e],o=window.document.documentElement;return n.some(function(r){return r in o.style})}return!1};function jn(t,e){return bi(t)}const xi=t=>typeof t!="object"&&typeof t!="function"||t===null;var wi={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M912 192H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 284H328c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h584c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM104 228a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0zm0 284a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"bars",theme:"outlined"},Ci=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:wi}))},Si=i.forwardRef(Ci);const Co=i.createContext({siderHook:{addSider:()=>null,removeSider:()=>null}}),Ei=t=>{const{antCls:e,componentCls:n,colorText:o,footerBg:r,headerHeight:s,headerPadding:a,headerColor:c,footerPadding:l,fontSize:d,bodyBg:f,headerBg:u}=t;return{[n]:{display:"flex",flex:"auto",flexDirection:"column",minHeight:0,background:f,"&, *":{boxSizing:"border-box"},[`&${n}-has-sider`]:{flexDirection:"row",[`> ${n}, > ${n}-content`]:{width:0}},[`${n}-header, &${n}-footer`]:{flex:"0 0 auto"},"&-rtl":{direction:"rtl"}},[`${n}-header`]:{height:s,padding:a,color:c,lineHeight:H(s),background:u,[`${e}-menu`]:{lineHeight:"inherit"}},[`${n}-footer`]:{padding:l,color:o,fontSize:d,background:r},[`${n}-content`]:{flex:"auto",color:o,minHeight:0}}},So=t=>{const{colorBgLayout:e,controlHeight:n,controlHeightLG:o,colorText:r,controlHeightSM:s,marginXXS:a,colorTextLightSolid:c,colorBgContainer:l}=t,d=o*1.25;return{colorBgHeader:"#001529",colorBgBody:e,colorBgTrigger:"#002140",bodyBg:e,headerBg:"#001529",headerHeight:n*2,headerPadding:`0 ${d}px`,headerColor:r,footerPadding:`${s}px ${d}px`,footerBg:e,siderBg:"#001529",triggerHeight:o+a*2,triggerBg:"#002140",triggerColor:c,zeroTriggerWidth:o,zeroTriggerHeight:o,lightSiderBg:l,lightTriggerBg:l,lightTriggerColor:r}},Eo=[["colorBgBody","bodyBg"],["colorBgHeader","headerBg"],["colorBgTrigger","triggerBg"]],$o=Je("Layout",Ei,So,{deprecatedTokens:Eo}),$i=t=>{const{componentCls:e,siderBg:n,motionDurationMid:o,motionDurationSlow:r,antCls:s,triggerHeight:a,triggerColor:c,triggerBg:l,headerHeight:d,zeroTriggerWidth:f,zeroTriggerHeight:u,borderRadiusLG:m,lightSiderBg:p,lightTriggerColor:h,lightTriggerBg:g,bodyBg:x}=t;return{[e]:{position:"relative",minWidth:0,background:n,transition:`all ${o}, background 0s`,"&-has-trigger":{paddingBottom:a},"&-right":{order:1},[`${e}-children`]:{height:"100%",marginTop:-.1,paddingTop:.1,[`${s}-menu${s}-menu-inline-collapsed`]:{width:"auto"}},[`&-zero-width ${e}-children`]:{overflow:"hidden"},[`${e}-trigger`]:{position:"fixed",bottom:0,zIndex:1,height:a,color:c,lineHeight:H(a),textAlign:"center",background:l,cursor:"pointer",transition:`all ${o}`},[`${e}-zero-width-trigger`]:{position:"absolute",top:d,insetInlineEnd:t.calc(f).mul(-1).equal(),zIndex:1,width:f,height:u,color:c,fontSize:t.fontSizeXL,display:"flex",alignItems:"center",justifyContent:"center",background:n,borderRadius:`0 ${H(m)} ${H(m)} 0`,cursor:"pointer",transition:`background ${r} ease`,"&::after":{position:"absolute",inset:0,background:"transparent",transition:`all ${r}`,content:'""'},"&:hover::after":{background:"rgba(255, 255, 255, 0.2)"},"&-right":{insetInlineStart:t.calc(f).mul(-1).equal(),borderRadius:`${H(m)} 0 0 ${H(m)}`}},"&-light":{background:p,[`${e}-trigger`]:{color:h,background:g},[`${e}-zero-width-trigger`]:{color:h,background:g,border:`1px solid ${x}`,borderInlineStart:0}}}}},Oi=Je(["Layout","Sider"],$i,So,{deprecatedTokens:Eo});var Ii=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]]);return n};const Ln={xs:"479.98px",sm:"575.98px",md:"767.98px",lg:"991.98px",xl:"1199.98px",xxl:"1599.98px"},Ti=t=>!Number.isNaN(Number.parseFloat(t))&&isFinite(t),At=i.createContext({}),Ri=(()=>{let t=0;return(e="")=>(t+=1,`${e}${t}`)})(),Oo=i.forwardRef((t,e)=>{const{prefixCls:n,className:o,trigger:r,children:s,defaultCollapsed:a=!1,theme:c="dark",style:l={},collapsible:d=!1,reverseArrow:f=!1,width:u=200,collapsedWidth:m=80,zeroWidthTriggerStyle:p,breakpoint:h,onCollapse:g,onBreakpoint:x}=t,v=Ii(t,["prefixCls","className","trigger","children","defaultCollapsed","theme","style","collapsible","reverseArrow","width","collapsedWidth","zeroWidthTriggerStyle","breakpoint","onCollapse","onBreakpoint"]),{siderHook:$}=i.useContext(Co),[I,S]=i.useState("collapsed"in t?t.collapsed:a),[y,_]=i.useState(!1);i.useEffect(()=>{"collapsed"in t&&S(t.collapsed)},[t.collapsed]);const w=(F,re)=>{"collapsed"in t||S(F),g?.(F,re)},{getPrefixCls:C,direction:O}=i.useContext(Ae),T=C("layout-sider",n),[R,P,M]=Oi(T),E=i.useRef(null);E.current=F=>{_(F.matches),x?.(F.matches),I!==F.matches&&w(F.matches,"responsive")},i.useEffect(()=>{function F(te){var ne;return(ne=E.current)===null||ne===void 0?void 0:ne.call(E,te)}let re;return typeof window?.matchMedia<"u"&&h&&h in Ln&&(re=window.matchMedia(`screen and (max-width: ${Ln[h]})`),Hr(re,F),F(re)),()=>{Fr(re,F)}},[h]),i.useEffect(()=>{const F=Ri("ant-sider-");return $.addSider(F),()=>$.removeSider(F)},[]);const N=()=>{w(!I,"clickTrigger")},A=De(v,["collapsed"]),B=I?m:u,k=Ti(B)?`${B}px`:String(B),D=parseFloat(String(m||0))===0?i.createElement("span",{onClick:N,className:U(`${T}-zero-width-trigger`,`${T}-zero-width-trigger-${f?"right":"left"}`),style:p},r||i.createElement(Si,null)):null,q=O==="rtl"==!f,L={expanded:q?i.createElement(Ge,null):i.createElement(Ye,null),collapsed:q?i.createElement(Ye,null):i.createElement(Ge,null)}[I?"collapsed":"expanded"],J=r!==null?D||i.createElement("div",{className:`${T}-trigger`,onClick:N,style:{width:k}},r||L):null,Z=Object.assign(Object.assign({},l),{flex:`0 0 ${k}`,maxWidth:k,minWidth:k,width:k}),X=U(T,`${T}-${c}`,{[`${T}-collapsed`]:!!I,[`${T}-has-trigger`]:d&&r!==null&&!D,[`${T}-below`]:!!y,[`${T}-zero-width`]:parseFloat(k)===0},o,P,M),oe=i.useMemo(()=>({siderCollapsed:I}),[I]);return R(i.createElement(At.Provider,{value:oe},i.createElement("aside",Object.assign({className:X},A,{style:Z,ref:e}),i.createElement("div",{className:`${T}-children`},s),d||y&&D?J:null)))}),Ot=i.createContext({prefixCls:"",firstLevel:!0,inlineCollapsed:!1});var _i=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]]);return n};const Io=t=>{const{prefixCls:e,className:n,dashed:o}=t,r=_i(t,["prefixCls","className","dashed"]),{getPrefixCls:s}=i.useContext(Ae),a=s("menu",e),c=U({[`${a}-item-divider-dashed`]:!!o},n);return i.createElement(Vr,Object.assign({className:c},r))},To=t=>{var e;const{className:n,children:o,icon:r,title:s,danger:a,extra:c}=t,{prefixCls:l,firstLevel:d,direction:f,disableMenuItemTitleTooltip:u,inlineCollapsed:m}=i.useContext(Ot),p=I=>{const S=o?.[0],y=i.createElement("span",{className:U(`${l}-title-content`,{[`${l}-title-content-with-extra`]:!!c||c===0})},o);return(!r||i.isValidElement(o)&&o.type==="span")&&o&&I&&d&&typeof S=="string"?i.createElement("div",{className:`${l}-inline-collapsed-noicon`},S.charAt(0)):y},{siderCollapsed:h}=i.useContext(At);let g=s;typeof s>"u"?g=d?o:"":s===!1&&(g="");const x={title:g};!h&&!m&&(x.title=null,x.open=!1);const v=dt(o).length;let $=i.createElement(Ur,Object.assign({},De(t,["title","icon","danger"]),{className:U({[`${l}-item-danger`]:a,[`${l}-item-only-child`]:(r?v+1:v)===1},n),title:typeof s=="string"?s:void 0}),ut(r,{className:U(i.isValidElement(r)?(e=r.props)===null||e===void 0?void 0:e.className:void 0,`${l}-item-icon`)}),p(m));return u||($=i.createElement(Mt,Object.assign({},x,{placement:f==="rtl"?"left":"right",classNames:{root:`${l}-inline-collapsed-tooltip`}}),$)),$};var Ni=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]]);return n};const It=i.createContext(null),Mi=i.forwardRef((t,e)=>{const{children:n}=t,o=Ni(t,["children"]),r=i.useContext(It),s=i.useMemo(()=>Object.assign(Object.assign({},r),o),[r,o.prefixCls,o.mode,o.selectable,o.rootClassName]),a=mr(n),c=pr(e,a?hr(n):null);return i.createElement(It.Provider,{value:s},i.createElement(Wr,{space:!0},a?i.cloneElement(n,{ref:c}):n))}),Pi=t=>{const{componentCls:e,motionDurationSlow:n,horizontalLineHeight:o,colorSplit:r,lineWidth:s,lineType:a,itemPaddingInline:c}=t;return{[`${e}-horizontal`]:{lineHeight:o,border:0,borderBottom:`${H(s)} ${a} ${r}`,boxShadow:"none","&::after":{display:"block",clear:"both",height:0,content:'"\\20"'},[`${e}-item, ${e}-submenu`]:{position:"relative",display:"inline-block",verticalAlign:"bottom",paddingInline:c},[`> ${e}-item:hover,
        > ${e}-item-active,
        > ${e}-submenu ${e}-submenu-title:hover`]:{backgroundColor:"transparent"},[`${e}-item, ${e}-submenu-title`]:{transition:[`border-color ${n}`,`background ${n}`].join(",")},[`${e}-submenu-arrow`]:{display:"none"}}}},Bi=({componentCls:t,menuArrowOffset:e,calc:n})=>({[`${t}-rtl`]:{direction:"rtl"},[`${t}-submenu-rtl`]:{transformOrigin:"100% 0"},[`${t}-rtl${t}-vertical,
    ${t}-submenu-rtl ${t}-vertical`]:{[`${t}-submenu-arrow`]:{"&::before":{transform:`rotate(-45deg) translateY(${H(n(e).mul(-1).equal())})`},"&::after":{transform:`rotate(45deg) translateY(${H(e)})`}}}}),zn=t=>gr(t),Dn=(t,e)=>{const{componentCls:n,itemColor:o,itemSelectedColor:r,subMenuItemSelectedColor:s,groupTitleColor:a,itemBg:c,subMenuItemBg:l,itemSelectedBg:d,activeBarHeight:f,activeBarWidth:u,activeBarBorderWidth:m,motionDurationSlow:p,motionEaseInOut:h,motionEaseOut:g,itemPaddingInline:x,motionDurationMid:v,itemHoverColor:$,lineType:I,colorSplit:S,itemDisabledColor:y,dangerItemColor:_,dangerItemHoverColor:w,dangerItemSelectedColor:C,dangerItemActiveBg:O,dangerItemSelectedBg:T,popupBg:R,itemHoverBg:P,itemActiveBg:M,menuSubMenuBg:E,horizontalItemSelectedColor:N,horizontalItemSelectedBg:A,horizontalItemBorderRadius:B,horizontalItemHoverBg:k}=t;return{[`${n}-${e}, ${n}-${e} > ${n}`]:{color:o,background:c,[`&${n}-root:focus-visible`]:Object.assign({},zn(t)),[`${n}-item`]:{"&-group-title, &-extra":{color:a}},[`${n}-submenu-selected > ${n}-submenu-title`]:{color:s},[`${n}-item, ${n}-submenu-title`]:{color:o,[`&:not(${n}-item-disabled):focus-visible`]:Object.assign({},zn(t))},[`${n}-item-disabled, ${n}-submenu-disabled`]:{color:`${y} !important`},[`${n}-item:not(${n}-item-selected):not(${n}-submenu-selected)`]:{[`&:hover, > ${n}-submenu-title:hover`]:{color:$}},[`&:not(${n}-horizontal)`]:{[`${n}-item:not(${n}-item-selected)`]:{"&:hover":{backgroundColor:P},"&:active":{backgroundColor:M}},[`${n}-submenu-title`]:{"&:hover":{backgroundColor:P},"&:active":{backgroundColor:M}}},[`${n}-item-danger`]:{color:_,[`&${n}-item:hover`]:{[`&:not(${n}-item-selected):not(${n}-submenu-selected)`]:{color:w}},[`&${n}-item:active`]:{background:O}},[`${n}-item a`]:{"&, &:hover":{color:"inherit"}},[`${n}-item-selected`]:{color:r,[`&${n}-item-danger`]:{color:C},"a, a:hover":{color:"inherit"}},[`& ${n}-item-selected`]:{backgroundColor:d,[`&${n}-item-danger`]:{backgroundColor:T}},[`&${n}-submenu > ${n}`]:{backgroundColor:E},[`&${n}-popup > ${n}`]:{backgroundColor:R},[`&${n}-submenu-popup > ${n}`]:{backgroundColor:R},[`&${n}-horizontal`]:Object.assign(Object.assign({},e==="dark"?{borderBottom:0}:{}),{[`> ${n}-item, > ${n}-submenu`]:{top:m,marginTop:t.calc(m).mul(-1).equal(),marginBottom:0,borderRadius:B,"&::after":{position:"absolute",insetInline:x,bottom:0,borderBottom:`${H(f)} solid transparent`,transition:`border-color ${p} ${h}`,content:'""'},"&:hover, &-active, &-open":{background:k,"&::after":{borderBottomWidth:f,borderBottomColor:N}},"&-selected":{color:N,backgroundColor:A,"&:hover":{backgroundColor:A},"&::after":{borderBottomWidth:f,borderBottomColor:N}}}}),[`&${n}-root`]:{[`&${n}-inline, &${n}-vertical`]:{borderInlineEnd:`${H(m)} ${I} ${S}`}},[`&${n}-inline`]:{[`${n}-sub${n}-inline`]:{background:l},[`${n}-item`]:{position:"relative","&::after":{position:"absolute",insetBlock:0,insetInlineEnd:0,borderInlineEnd:`${H(u)} solid ${r}`,transform:"scaleY(0.0001)",opacity:0,transition:[`transform ${v} ${g}`,`opacity ${v} ${g}`].join(","),content:'""'},[`&${n}-item-danger`]:{"&::after":{borderInlineEndColor:C}}},[`${n}-selected, ${n}-item-selected`]:{"&::after":{transform:"scaleY(1)",opacity:1,transition:[`transform ${v} ${h}`,`opacity ${v} ${h}`].join(",")}}}}}},Hn=t=>{const{componentCls:e,itemHeight:n,itemMarginInline:o,padding:r,menuArrowSize:s,marginXS:a,itemMarginBlock:c,itemWidth:l,itemPaddingInline:d}=t,f=t.calc(s).add(r).add(a).equal();return{[`${e}-item`]:{position:"relative",overflow:"hidden"},[`${e}-item, ${e}-submenu-title`]:{height:n,lineHeight:H(n),paddingInline:d,overflow:"hidden",textOverflow:"ellipsis",marginInline:o,marginBlock:c,width:l},[`> ${e}-item,
            > ${e}-submenu > ${e}-submenu-title`]:{height:n,lineHeight:H(n)},[`${e}-item-group-list ${e}-submenu-title,
            ${e}-submenu-title`]:{paddingInlineEnd:f}}},ki=t=>{const{componentCls:e,iconCls:n,itemHeight:o,colorTextLightSolid:r,dropdownWidth:s,controlHeightLG:a,motionEaseOut:c,paddingXL:l,itemMarginInline:d,fontSizeLG:f,motionDurationFast:u,motionDurationSlow:m,paddingXS:p,boxShadowSecondary:h,collapsedWidth:g,collapsedIconSize:x}=t,v={height:o,lineHeight:H(o),listStylePosition:"inside",listStyleType:"disc"};return[{[e]:{"&-inline, &-vertical":Object.assign({[`&${e}-root`]:{boxShadow:"none"}},Hn(t))},[`${e}-submenu-popup`]:{[`${e}-vertical`]:Object.assign(Object.assign({},Hn(t)),{boxShadow:h})}},{[`${e}-submenu-popup ${e}-vertical${e}-sub`]:{minWidth:s,maxHeight:`calc(100vh - ${H(t.calc(a).mul(2.5).equal())})`,padding:"0",overflow:"hidden",borderInlineEnd:0,"&:not([class*='-active'])":{overflowX:"hidden",overflowY:"auto"}}},{[`${e}-inline`]:{width:"100%",[`&${e}-root`]:{[`${e}-item, ${e}-submenu-title`]:{display:"flex",alignItems:"center",transition:[`border-color ${m}`,`background ${m}`,`padding ${u} ${c}`].join(","),[`> ${e}-title-content`]:{flex:"auto",minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},"> *":{flex:"none"}}},[`${e}-sub${e}-inline`]:{padding:0,border:0,borderRadius:0,boxShadow:"none",[`& > ${e}-submenu > ${e}-submenu-title`]:v,[`& ${e}-item-group-title`]:{paddingInlineStart:l}},[`${e}-item`]:v}},{[`${e}-inline-collapsed`]:{width:g,[`&${e}-root`]:{[`${e}-item, ${e}-submenu ${e}-submenu-title`]:{[`> ${e}-inline-collapsed-noicon`]:{fontSize:f,textAlign:"center"}}},[`> ${e}-item,
          > ${e}-item-group > ${e}-item-group-list > ${e}-item,
          > ${e}-item-group > ${e}-item-group-list > ${e}-submenu > ${e}-submenu-title,
          > ${e}-submenu > ${e}-submenu-title`]:{insetInlineStart:0,paddingInline:`calc(50% - ${H(t.calc(x).div(2).equal())} - ${H(d)})`,textOverflow:"clip",[`
            ${e}-submenu-arrow,
            ${e}-submenu-expand-icon
          `]:{opacity:0},[`${e}-item-icon, ${n}`]:{margin:0,fontSize:x,lineHeight:H(o),"+ span":{display:"inline-block",opacity:0}}},[`${e}-item-icon, ${n}`]:{display:"inline-block"},"&-tooltip":{pointerEvents:"none",[`${e}-item-icon, ${n}`]:{display:"none"},"a, a:hover":{color:r}},[`${e}-item-group-title`]:Object.assign(Object.assign({},uo),{paddingInline:p})}}]},Fn=t=>{const{componentCls:e,motionDurationSlow:n,motionDurationMid:o,motionEaseInOut:r,motionEaseOut:s,iconCls:a,iconSize:c,iconMarginInlineEnd:l}=t;return{[`${e}-item, ${e}-submenu-title`]:{position:"relative",display:"block",margin:0,whiteSpace:"nowrap",cursor:"pointer",transition:[`border-color ${n}`,`background ${n}`,`padding calc(${n} + 0.1s) ${r}`].join(","),[`${e}-item-icon, ${a}`]:{minWidth:c,fontSize:c,transition:[`font-size ${o} ${s}`,`margin ${n} ${r}`,`color ${n}`].join(","),"+ span":{marginInlineStart:l,opacity:1,transition:[`opacity ${n} ${r}`,`margin ${n}`,`color ${n}`].join(",")}},[`${e}-item-icon`]:Object.assign({},vr()),[`&${e}-item-only-child`]:{[`> ${a}, > ${e}-item-icon`]:{marginInlineEnd:0}}},[`${e}-item-disabled, ${e}-submenu-disabled`]:{background:"none !important",cursor:"not-allowed","&::after":{borderColor:"transparent !important"},a:{color:"inherit !important",cursor:"not-allowed",pointerEvents:"none"},[`> ${e}-submenu-title`]:{color:"inherit !important",cursor:"not-allowed"}}}},Vn=t=>{const{componentCls:e,motionDurationSlow:n,motionEaseInOut:o,borderRadius:r,menuArrowSize:s,menuArrowOffset:a}=t;return{[`${e}-submenu`]:{"&-expand-icon, &-arrow":{position:"absolute",top:"50%",insetInlineEnd:t.margin,width:s,color:"currentcolor",transform:"translateY(-50%)",transition:`transform ${n} ${o}, opacity ${n}`},"&-arrow":{"&::before, &::after":{position:"absolute",width:t.calc(s).mul(.6).equal(),height:t.calc(s).mul(.15).equal(),backgroundColor:"currentcolor",borderRadius:r,transition:[`background ${n} ${o}`,`transform ${n} ${o}`,`top ${n} ${o}`,`color ${n} ${o}`].join(","),content:'""'},"&::before":{transform:`rotate(45deg) translateY(${H(t.calc(a).mul(-1).equal())})`},"&::after":{transform:`rotate(-45deg) translateY(${H(a)})`}}}}},Ai=t=>{const{antCls:e,componentCls:n,fontSize:o,motionDurationSlow:r,motionDurationMid:s,motionEaseInOut:a,paddingXS:c,padding:l,colorSplit:d,lineWidth:f,zIndexPopup:u,borderRadiusLG:m,subMenuItemBorderRadius:p,menuArrowSize:h,menuArrowOffset:g,lineType:x,groupTitleLineHeight:v,groupTitleFontSize:$}=t;return[{"":{[n]:Object.assign(Object.assign({},Rn()),{"&-hidden":{display:"none"}})},[`${n}-submenu-hidden`]:{display:"none"}},{[n]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},fo(t)),Rn()),{marginBottom:0,paddingInlineStart:0,fontSize:o,lineHeight:0,listStyle:"none",outline:"none",transition:`width ${r} cubic-bezier(0.2, 0, 0, 1) 0s`,"ul, ol":{margin:0,padding:0,listStyle:"none"},"&-overflow":{display:"flex",[`${n}-item`]:{flex:"none"}},[`${n}-item, ${n}-submenu, ${n}-submenu-title`]:{borderRadius:t.itemBorderRadius},[`${n}-item-group-title`]:{padding:`${H(c)} ${H(l)}`,fontSize:$,lineHeight:v,transition:`all ${r}`},[`&-horizontal ${n}-submenu`]:{transition:[`border-color ${r} ${a}`,`background ${r} ${a}`].join(",")},[`${n}-submenu, ${n}-submenu-inline`]:{transition:[`border-color ${r} ${a}`,`background ${r} ${a}`,`padding ${s} ${a}`].join(",")},[`${n}-submenu ${n}-sub`]:{cursor:"initial",transition:[`background ${r} ${a}`,`padding ${r} ${a}`].join(",")},[`${n}-title-content`]:{transition:`color ${r}`,"&-with-extra":{display:"inline-flex",alignItems:"center",width:"100%"},[`> ${e}-typography-ellipsis-single-line`]:{display:"inline",verticalAlign:"unset"},[`${n}-item-extra`]:{marginInlineStart:"auto",paddingInlineStart:t.padding}},[`${n}-item a`]:{"&::before":{position:"absolute",inset:0,backgroundColor:"transparent",content:'""'}},[`${n}-item-divider`]:{overflow:"hidden",lineHeight:0,borderColor:d,borderStyle:x,borderWidth:0,borderTopWidth:f,marginBlock:f,padding:0,"&-dashed":{borderStyle:"dashed"}}}),Fn(t)),{[`${n}-item-group`]:{[`${n}-item-group-list`]:{margin:0,padding:0,[`${n}-item, ${n}-submenu-title`]:{paddingInline:`${H(t.calc(o).mul(2).equal())} ${H(l)}`}}},"&-submenu":{"&-popup":{position:"absolute",zIndex:u,borderRadius:m,boxShadow:"none",transformOrigin:"0 0",[`&${n}-submenu`]:{background:"transparent"},"&::before":{position:"absolute",inset:0,zIndex:-1,width:"100%",height:"100%",opacity:0,content:'""'},[`> ${n}`]:Object.assign(Object.assign(Object.assign({borderRadius:m},Fn(t)),Vn(t)),{[`${n}-item, ${n}-submenu > ${n}-submenu-title`]:{borderRadius:p},[`${n}-submenu-title::after`]:{transition:`transform ${r} ${a}`}})},"\n          &-placement-leftTop,\n          &-placement-bottomRight,\n          ":{transformOrigin:"100% 0"},"\n          &-placement-leftBottom,\n          &-placement-topRight,\n          ":{transformOrigin:"100% 100%"},"\n          &-placement-rightBottom,\n          &-placement-topLeft,\n          ":{transformOrigin:"0 100%"},"\n          &-placement-bottomLeft,\n          &-placement-rightTop,\n          ":{transformOrigin:"0 0"},"\n          &-placement-leftTop,\n          &-placement-leftBottom\n          ":{paddingInlineEnd:t.paddingXS},"\n          &-placement-rightTop,\n          &-placement-rightBottom\n          ":{paddingInlineStart:t.paddingXS},"\n          &-placement-topRight,\n          &-placement-topLeft\n          ":{paddingBottom:t.paddingXS},"\n          &-placement-bottomRight,\n          &-placement-bottomLeft\n          ":{paddingTop:t.paddingXS}}}),Vn(t)),{[`&-inline-collapsed ${n}-submenu-arrow,
        &-inline ${n}-submenu-arrow`]:{"&::before":{transform:`rotate(-45deg) translateX(${H(g)})`},"&::after":{transform:`rotate(45deg) translateX(${H(t.calc(g).mul(-1).equal())})`}},[`${n}-submenu-open${n}-submenu-inline > ${n}-submenu-title > ${n}-submenu-arrow`]:{transform:`translateY(${H(t.calc(h).mul(.2).mul(-1).equal())})`,"&::after":{transform:`rotate(-45deg) translateX(${H(t.calc(g).mul(-1).equal())})`},"&::before":{transform:`rotate(45deg) translateX(${H(g)})`}}})},{[`${e}-layout-header`]:{[n]:{lineHeight:"inherit"}}}]},ji=t=>{var e,n,o;const{colorPrimary:r,colorError:s,colorTextDisabled:a,colorErrorBg:c,colorText:l,colorTextDescription:d,colorBgContainer:f,colorFillAlter:u,colorFillContent:m,lineWidth:p,lineWidthBold:h,controlItemBgActive:g,colorBgTextHover:x,controlHeightLG:v,lineHeight:$,colorBgElevated:I,marginXXS:S,padding:y,fontSize:_,controlHeightSM:w,fontSizeLG:C,colorTextLightSolid:O,colorErrorHover:T}=t,R=(e=t.activeBarWidth)!==null&&e!==void 0?e:0,P=(n=t.activeBarBorderWidth)!==null&&n!==void 0?n:p,M=(o=t.itemMarginInline)!==null&&o!==void 0?o:t.marginXXS,E=new Be(O).setA(.65).toRgbString();return{dropdownWidth:160,zIndexPopup:t.zIndexPopupBase+50,radiusItem:t.borderRadiusLG,itemBorderRadius:t.borderRadiusLG,radiusSubMenuItem:t.borderRadiusSM,subMenuItemBorderRadius:t.borderRadiusSM,colorItemText:l,itemColor:l,colorItemTextHover:l,itemHoverColor:l,colorItemTextHoverHorizontal:r,horizontalItemHoverColor:r,colorGroupTitle:d,groupTitleColor:d,colorItemTextSelected:r,itemSelectedColor:r,subMenuItemSelectedColor:r,colorItemTextSelectedHorizontal:r,horizontalItemSelectedColor:r,colorItemBg:f,itemBg:f,colorItemBgHover:x,itemHoverBg:x,colorItemBgActive:m,itemActiveBg:g,colorSubItemBg:u,subMenuItemBg:u,colorItemBgSelected:g,itemSelectedBg:g,colorItemBgSelectedHorizontal:"transparent",horizontalItemSelectedBg:"transparent",colorActiveBarWidth:0,activeBarWidth:R,colorActiveBarHeight:h,activeBarHeight:h,colorActiveBarBorderSize:p,activeBarBorderWidth:P,colorItemTextDisabled:a,itemDisabledColor:a,colorDangerItemText:s,dangerItemColor:s,colorDangerItemTextHover:s,dangerItemHoverColor:s,colorDangerItemTextSelected:s,dangerItemSelectedColor:s,colorDangerItemBgActive:c,dangerItemActiveBg:c,colorDangerItemBgSelected:c,dangerItemSelectedBg:c,itemMarginInline:M,horizontalItemBorderRadius:0,horizontalItemHoverBg:"transparent",itemHeight:v,groupTitleLineHeight:$,collapsedWidth:v*2,popupBg:I,itemMarginBlock:S,itemPaddingInline:y,horizontalLineHeight:`${v*1.15}px`,iconSize:_,iconMarginInlineEnd:w-_,collapsedIconSize:C,groupTitleFontSize:_,darkItemDisabledColor:new Be(O).setA(.25).toRgbString(),darkItemColor:E,darkDangerItemColor:s,darkItemBg:"#001529",darkPopupBg:"#001529",darkSubMenuItemBg:"#000c17",darkItemSelectedColor:O,darkItemSelectedBg:r,darkDangerItemSelectedBg:s,darkItemHoverBg:"transparent",darkGroupTitleColor:E,darkItemHoverColor:O,darkDangerItemHoverColor:T,darkDangerItemSelectedColor:O,darkDangerItemActiveBg:s,itemWidth:R?`calc(100% + ${P}px)`:`calc(100% - ${M*2}px)`}},Li=(t,e=t,n=!0)=>Je("Menu",r=>{const{colorBgElevated:s,controlHeightLG:a,fontSize:c,darkItemColor:l,darkDangerItemColor:d,darkItemBg:f,darkSubMenuItemBg:u,darkItemSelectedColor:m,darkItemSelectedBg:p,darkDangerItemSelectedBg:h,darkItemHoverBg:g,darkGroupTitleColor:x,darkItemHoverColor:v,darkItemDisabledColor:$,darkDangerItemHoverColor:I,darkDangerItemSelectedColor:S,darkDangerItemActiveBg:y,popupBg:_,darkPopupBg:w}=r,C=r.calc(c).div(7).mul(5).equal(),O=lt(r,{menuArrowSize:C,menuHorizontalHeight:r.calc(a).mul(1.15).equal(),menuArrowOffset:r.calc(C).mul(.25).equal(),menuSubMenuBg:s,calc:r.calc,popupBg:_}),T=lt(O,{itemColor:l,itemHoverColor:v,groupTitleColor:x,itemSelectedColor:m,subMenuItemSelectedColor:m,itemBg:f,popupBg:w,subMenuItemBg:u,itemActiveBg:"transparent",itemSelectedBg:p,activeBarHeight:0,activeBarBorderWidth:0,itemHoverBg:g,itemDisabledColor:$,dangerItemColor:d,dangerItemHoverColor:I,dangerItemSelectedColor:S,dangerItemActiveBg:y,dangerItemSelectedBg:h,menuSubMenuBg:u,horizontalItemSelectedColor:m,horizontalItemSelectedBg:p});return[Ai(O),Pi(O),ki(O),Dn(O,"light"),Dn(T,"dark"),Bi(O),qr(O),Et(O,"slide-up"),Et(O,"slide-down"),gn(O,"zoom-big")]},ji,{deprecatedTokens:[["colorGroupTitle","groupTitleColor"],["radiusItem","itemBorderRadius"],["radiusSubMenuItem","subMenuItemBorderRadius"],["colorItemText","itemColor"],["colorItemTextHover","itemHoverColor"],["colorItemTextHoverHorizontal","horizontalItemHoverColor"],["colorItemTextSelected","itemSelectedColor"],["colorItemTextSelectedHorizontal","horizontalItemSelectedColor"],["colorItemTextDisabled","itemDisabledColor"],["colorDangerItemText","dangerItemColor"],["colorDangerItemTextHover","dangerItemHoverColor"],["colorDangerItemTextSelected","dangerItemSelectedColor"],["colorDangerItemBgActive","dangerItemActiveBg"],["colorDangerItemBgSelected","dangerItemSelectedBg"],["colorItemBg","itemBg"],["colorItemBgHover","itemHoverBg"],["colorSubItemBg","subMenuItemBg"],["colorItemBgActive","itemActiveBg"],["colorItemBgSelectedHorizontal","horizontalItemSelectedBg"],["colorActiveBarWidth","activeBarWidth"],["colorActiveBarHeight","activeBarHeight"],["colorActiveBarBorderSize","activeBarBorderWidth"],["colorItemBgSelected","itemSelectedBg"]],injectStyle:n,unitless:{groupTitleLineHeight:!0}})(t,e),Ro=t=>{var e;const{popupClassName:n,icon:o,title:r,theme:s}=t,a=i.useContext(Ot),{prefixCls:c,inlineCollapsed:l,theme:d}=a,f=Xr();let u;if(!o)u=l&&!f.length&&r&&typeof r=="string"?i.createElement("div",{className:`${c}-inline-collapsed-noicon`},r.charAt(0)):i.createElement("span",{className:`${c}-title-content`},r);else{const h=i.isValidElement(r)&&r.type==="span";u=i.createElement(i.Fragment,null,ut(o,{className:U(i.isValidElement(o)?(e=o.props)===null||e===void 0?void 0:e.className:void 0,`${c}-item-icon`)}),h?r:i.createElement("span",{className:`${c}-title-content`},r))}const m=i.useMemo(()=>Object.assign(Object.assign({},a),{firstLevel:!1}),[a]),[p]=Pt("Menu");return i.createElement(Ot.Provider,{value:m},i.createElement(Yr,Object.assign({},De(t,["icon"]),{title:u,popupClassName:U(c,n,`${c}-${s||d}`),popupStyle:Object.assign({zIndex:p},t.popupStyle)})))};var zi=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]]);return n};function Wt(t){return t===null||t===!1}const Di={item:To,submenu:Ro,divider:Io},Hi=i.forwardRef((t,e)=>{var n;const o=i.useContext(It),r=o||{},{getPrefixCls:s,getPopupContainer:a,direction:c,menu:l}=i.useContext(Ae),d=s(),{prefixCls:f,className:u,style:m,theme:p="light",expandIcon:h,_internalDisableMenuItemTitleTooltip:g,inlineCollapsed:x,siderCollapsed:v,rootClassName:$,mode:I,selectable:S,onClick:y,overflowedIndicatorPopupClassName:_}=t,w=zi(t,["prefixCls","className","style","theme","expandIcon","_internalDisableMenuItemTitleTooltip","inlineCollapsed","siderCollapsed","rootClassName","mode","selectable","onClick","overflowedIndicatorPopupClassName"]),C=De(w,["collapsedWidth"]);(n=r.validator)===null||n===void 0||n.call(r,{mode:I});const O=hn((...K)=>{var L;y?.apply(void 0,K),(L=r.onClick)===null||L===void 0||L.call(r)}),T=r.mode||I,R=S??r.selectable,P=x??v,M={horizontal:{motionName:`${d}-slide-up`},inline:Kr(d),other:{motionName:`${d}-zoom-big`}},E=s("menu",f||r.prefixCls),N=Bt(E),[A,B,k]=Li(E,N,!o),D=U(`${E}-${p}`,l?.className,u),q=i.useMemo(()=>{var K,L;if(typeof h=="function"||Wt(h))return h||null;if(typeof r.expandIcon=="function"||Wt(r.expandIcon))return r.expandIcon||null;if(typeof l?.expandIcon=="function"||Wt(l?.expandIcon))return l?.expandIcon||null;const J=(K=h??r?.expandIcon)!==null&&K!==void 0?K:l?.expandIcon;return ut(J,{className:U(`${E}-submenu-expand-icon`,i.isValidElement(J)?(L=J.props)===null||L===void 0?void 0:L.className:void 0)})},[h,r?.expandIcon,l?.expandIcon,E]),G=i.useMemo(()=>({prefixCls:E,inlineCollapsed:P||!1,direction:c,firstLevel:!0,theme:p,mode:T,disableMenuItemTitleTooltip:g}),[E,P,c,g,p]);return A(i.createElement(It.Provider,{value:null},i.createElement(Ot.Provider,{value:G},i.createElement(Gr,Object.assign({getPopupContainer:a,overflowedIndicator:i.createElement(vn,null),overflowedIndicatorPopupClassName:U(E,`${E}-${p}`,_),mode:T,selectable:R,onClick:O},C,{inlineCollapsed:P,style:Object.assign(Object.assign({},l?.style),m),className:D,prefixCls:E,direction:c,defaultMotions:M,expandIcon:q,ref:e,rootClassName:U($,B,r.rootClassName,k,N),_internalComponents:Di})))))}),ft=i.forwardRef((t,e)=>{const n=i.useRef(null),o=i.useContext(At);return i.useImperativeHandle(e,()=>({menu:n.current,focus:r=>{var s;(s=n.current)===null||s===void 0||s.focus(r)}})),i.createElement(Hi,Object.assign({ref:n},t,o))});ft.Item=To;ft.SubMenu=Ro;ft.Divider=Io;ft.ItemGroup=Zr;const Fi=t=>{const{componentCls:e,menuCls:n,colorError:o,colorTextLightSolid:r}=t,s=`${n}-item`;return{[`${e}, ${e}-menu-submenu`]:{[`${n} ${s}`]:{[`&${s}-danger:not(${s}-disabled)`]:{color:o,"&:hover":{color:r,backgroundColor:o}}}}}},Vi=t=>{const{componentCls:e,menuCls:n,zIndexPopup:o,dropdownArrowDistance:r,sizePopupArrow:s,antCls:a,iconCls:c,motionDurationMid:l,paddingBlock:d,fontSize:f,dropdownEdgeChildPadding:u,colorTextDisabled:m,fontSizeIcon:p,controlPaddingHorizontal:h,colorBgElevated:g}=t;return[{[e]:{position:"absolute",top:-9999,left:{_skip_check_:!0,value:-9999},zIndex:o,display:"block","&::before":{position:"absolute",insetBlock:t.calc(s).div(2).sub(r).equal(),zIndex:-9999,opacity:1e-4,content:'""'},"&-menu-vertical":{maxHeight:"100vh",overflowY:"auto"},[`&-trigger${a}-btn`]:{[`& > ${c}-down, & > ${a}-btn-icon > ${c}-down`]:{fontSize:p}},[`${e}-wrap`]:{position:"relative",[`${a}-btn > ${c}-down`]:{fontSize:p},[`${c}-down::before`]:{transition:`transform ${l}`}},[`${e}-wrap-open`]:{[`${c}-down::before`]:{transform:"rotate(180deg)"}},"\n        &-hidden,\n        &-menu-hidden,\n        &-menu-submenu-hidden\n      ":{display:"none"},[`&${a}-slide-down-enter${a}-slide-down-enter-active${e}-placement-bottomLeft,
          &${a}-slide-down-appear${a}-slide-down-appear-active${e}-placement-bottomLeft,
          &${a}-slide-down-enter${a}-slide-down-enter-active${e}-placement-bottom,
          &${a}-slide-down-appear${a}-slide-down-appear-active${e}-placement-bottom,
          &${a}-slide-down-enter${a}-slide-down-enter-active${e}-placement-bottomRight,
          &${a}-slide-down-appear${a}-slide-down-appear-active${e}-placement-bottomRight`]:{animationName:ti},[`&${a}-slide-up-enter${a}-slide-up-enter-active${e}-placement-topLeft,
          &${a}-slide-up-appear${a}-slide-up-appear-active${e}-placement-topLeft,
          &${a}-slide-up-enter${a}-slide-up-enter-active${e}-placement-top,
          &${a}-slide-up-appear${a}-slide-up-appear-active${e}-placement-top,
          &${a}-slide-up-enter${a}-slide-up-enter-active${e}-placement-topRight,
          &${a}-slide-up-appear${a}-slide-up-appear-active${e}-placement-topRight`]:{animationName:ei},[`&${a}-slide-down-leave${a}-slide-down-leave-active${e}-placement-bottomLeft,
          &${a}-slide-down-leave${a}-slide-down-leave-active${e}-placement-bottom,
          &${a}-slide-down-leave${a}-slide-down-leave-active${e}-placement-bottomRight`]:{animationName:Jr},[`&${a}-slide-up-leave${a}-slide-up-leave-active${e}-placement-topLeft,
          &${a}-slide-up-leave${a}-slide-up-leave-active${e}-placement-top,
          &${a}-slide-up-leave${a}-slide-up-leave-active${e}-placement-topRight`]:{animationName:Qr}}},ni(t,g,{arrowPlacement:{top:!0,bottom:!0}}),{[`${e} ${n}`]:{position:"relative",margin:0},[`${n}-submenu-popup`]:{position:"absolute",zIndex:o,background:"transparent",boxShadow:"none",transformOrigin:"0 0","ul, li":{listStyle:"none",margin:0}},[`${e}, ${e}-menu-submenu`]:Object.assign(Object.assign({},fo(t)),{[n]:Object.assign(Object.assign({padding:u,listStyleType:"none",backgroundColor:g,backgroundClip:"padding-box",borderRadius:t.borderRadiusLG,outline:"none",boxShadow:t.boxShadowSecondary},_n(t)),{"&:empty":{padding:0,boxShadow:"none"},[`${n}-item-group-title`]:{padding:`${H(d)} ${H(h)}`,color:t.colorTextDescription,transition:`all ${l}`},[`${n}-item`]:{position:"relative",display:"flex",alignItems:"center"},[`${n}-item-icon`]:{minWidth:f,marginInlineEnd:t.marginXS,fontSize:t.fontSizeSM},[`${n}-title-content`]:{flex:"auto","&-with-extra":{display:"inline-flex",alignItems:"center",width:"100%"},"> a":{color:"inherit",transition:`all ${l}`,"&:hover":{color:"inherit"},"&::after":{position:"absolute",inset:0,content:'""'}},[`${n}-item-extra`]:{paddingInlineStart:t.padding,marginInlineStart:"auto",fontSize:t.fontSizeSM,color:t.colorTextDescription}},[`${n}-item, ${n}-submenu-title`]:Object.assign(Object.assign({display:"flex",margin:0,padding:`${H(d)} ${H(h)}`,color:t.colorText,fontWeight:"normal",fontSize:f,lineHeight:t.lineHeight,cursor:"pointer",transition:`all ${l}`,borderRadius:t.borderRadiusSM,"&:hover, &-active":{backgroundColor:t.controlItemBgHover}},_n(t)),{"&-selected":{color:t.colorPrimary,backgroundColor:t.controlItemBgActive,"&:hover, &-active":{backgroundColor:t.controlItemBgActiveHover}},"&-disabled":{color:m,cursor:"not-allowed","&:hover":{color:m,backgroundColor:g,cursor:"not-allowed"},a:{pointerEvents:"none"}},"&-divider":{height:1,margin:`${H(t.marginXXS)} 0`,overflow:"hidden",lineHeight:0,backgroundColor:t.colorSplit},[`${e}-menu-submenu-expand-icon`]:{position:"absolute",insetInlineEnd:t.paddingXS,[`${e}-menu-submenu-arrow-icon`]:{marginInlineEnd:"0 !important",color:t.colorIcon,fontSize:p,fontStyle:"normal"}}}),[`${n}-item-group-list`]:{margin:`0 ${H(t.marginXS)}`,padding:0,listStyle:"none"},[`${n}-submenu-title`]:{paddingInlineEnd:t.calc(h).add(t.fontSizeSM).equal()},[`${n}-submenu-vertical`]:{position:"relative"},[`${n}-submenu${n}-submenu-disabled ${e}-menu-submenu-title`]:{[`&, ${e}-menu-submenu-arrow-icon`]:{color:m,backgroundColor:g,cursor:"not-allowed"}},[`${n}-submenu-selected ${e}-menu-submenu-title`]:{color:t.colorPrimary}})})},[Et(t,"slide-up"),Et(t,"slide-down"),Pn(t,"move-up"),Pn(t,"move-down"),gn(t,"zoom-big")]]},Ui=t=>Object.assign(Object.assign({zIndexPopup:t.zIndexPopupBase+50,paddingBlock:(t.controlHeight-t.fontSize*t.lineHeight)/2},oi({contentRadius:t.borderRadiusLG,limitVerticalRadius:!0})),ri(t)),Wi=Je("Dropdown",t=>{const{marginXXS:e,sizePopupArrow:n,paddingXXS:o,componentCls:r}=t,s=lt(t,{menuCls:`${r}-menu`,dropdownArrowDistance:t.calc(n).div(2).add(e).equal(),dropdownEdgeChildPadding:o});return[Vi(s),Fi(s)]},Ui,{resetStyle:!1}),jt=t=>{var e;const{menu:n,arrow:o,prefixCls:r,children:s,trigger:a,disabled:c,dropdownRender:l,popupRender:d,getPopupContainer:f,overlayClassName:u,rootClassName:m,overlayStyle:p,open:h,onOpenChange:g,visible:x,onVisibleChange:v,mouseEnterDelay:$=.15,mouseLeaveDelay:I=.1,autoAdjustOverflow:S=!0,placement:y="",overlay:_,transitionName:w,destroyOnHidden:C,destroyPopupOnHide:O}=t,{getPopupContainer:T,getPrefixCls:R,direction:P,dropdown:M}=i.useContext(Ae),E=d||l;br();const N=i.useMemo(()=>{const z=R();return w!==void 0?w:y.includes("top")?`${z}-slide-down`:`${z}-slide-up`},[R,y,w]),A=i.useMemo(()=>y?y.includes("Center")?y.slice(0,y.indexOf("Center")):y:P==="rtl"?"bottomRight":"bottomLeft",[y,P]),B=R("dropdown",r),k=Bt(B),[D,q,G]=Wi(B,k),[,K]=yr(),L=i.Children.only(xi(s)?i.createElement("span",null,s):s),J=ut(L,{className:U(`${B}-trigger`,{[`${B}-rtl`]:P==="rtl"},L.props.className),disabled:(e=L.props.disabled)!==null&&e!==void 0?e:c}),Z=c?[]:a,X=!!Z?.includes("contextMenu"),[oe,F]=Ke(!1,{value:h??x}),re=hn(z=>{g?.(z,{source:"trigger"}),v?.(z),F(z)}),te=U(u,m,q,G,k,M?.className,{[`${B}-rtl`]:P==="rtl"}),ne=ii({arrowPointAtCenter:typeof o=="object"&&o.pointAtCenter,autoAdjustOverflow:S,offset:K.marginXXS,arrowWidth:o?K.sizePopupArrow:0,borderRadius:K.borderRadius}),Y=i.useCallback(()=>{n?.selectable&&n?.multiple||(g?.(!1,{source:"menu"}),F(!1))},[n?.selectable,n?.multiple]),ie=()=>{let z;return n?.items?z=i.createElement(ft,Object.assign({},n)):typeof _=="function"?z=_():z=_,E&&(z=E(z)),z=i.Children.only(typeof z=="string"?i.createElement("span",null,z):z),i.createElement(Mi,{prefixCls:`${B}-menu`,rootClassName:U(G,k),expandIcon:i.createElement("span",{className:`${B}-menu-submenu-arrow`},P==="rtl"?i.createElement(Ye,{className:`${B}-menu-submenu-arrow-icon`}):i.createElement(Ge,{className:`${B}-menu-submenu-arrow-icon`})),mode:"vertical",selectable:!1,onClick:Y,validator:({mode:Q})=>{}},z)},[he,se]=Pt("Dropdown",p?.zIndex);let ee=i.createElement(si,Object.assign({alignPoint:X},De(t,["rootClassName"]),{mouseEnterDelay:$,mouseLeaveDelay:I,visible:oe,builtinPlacements:ne,arrow:!!o,overlayClassName:te,prefixCls:B,getPopupContainer:f||T,transitionName:N,trigger:Z,overlay:ie,placement:A,onVisibleChange:re,overlayStyle:Object.assign(Object.assign(Object.assign({},M?.style),p),{zIndex:he}),autoDestroy:C??O}),J);return he&&(ee=i.createElement(ai.Provider,{value:se},ee)),D(ee)},qi=Ar(jt,"align",void 0,"dropdown",t=>t),Xi=t=>i.createElement(qi,Object.assign({},t),i.createElement("span",null));jt._InternalPanelDoNotUseOrYouWillBeFired=Xi;function Un(t){return["small","middle","large"].includes(t)}function Wn(t){return t?typeof t=="number"&&!Number.isNaN(t):!1}const _o=Le.createContext({latestIndex:0}),Yi=_o.Provider,Gi=({className:t,index:e,children:n,split:o,style:r})=>{const{latestIndex:s}=i.useContext(_o);return n==null?null:i.createElement(i.Fragment,null,i.createElement("div",{className:t,style:r},n),e<s&&o&&i.createElement("span",{className:`${t}-split`},o))};var Ki=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]]);return n};const Zi=i.forwardRef((t,e)=>{var n;const{getPrefixCls:o,direction:r,size:s,className:a,style:c,classNames:l,styles:d}=_t("space"),{size:f=s??"small",align:u,className:m,rootClassName:p,children:h,direction:g="horizontal",prefixCls:x,split:v,style:$,wrap:I=!1,classNames:S,styles:y}=t,_=Ki(t,["size","align","className","rootClassName","children","direction","prefixCls","split","style","wrap","classNames","styles"]),[w,C]=Array.isArray(f)?f:[f,f],O=Un(C),T=Un(w),R=Wn(C),P=Wn(w),M=dt(h,{keepEmpty:!0}),E=u===void 0&&g==="horizontal"?"center":u,N=o("space",x),[A,B,k]=li(N),D=U(N,a,B,`${N}-${g}`,{[`${N}-rtl`]:r==="rtl",[`${N}-align-${E}`]:E,[`${N}-gap-row-${C}`]:O,[`${N}-gap-col-${w}`]:T},m,p,k),q=U(`${N}-item`,(n=S?.item)!==null&&n!==void 0?n:l.item);let G=0;const K=M.map((Z,X)=>{var oe;Z!=null&&(G=X);const F=Z?.key||`${q}-${X}`;return i.createElement(Gi,{className:q,key:F,index:X,split:v,style:(oe=y?.item)!==null&&oe!==void 0?oe:d.item},Z)}),L=i.useMemo(()=>({latestIndex:G}),[G]);if(M.length===0)return null;const J={};return I&&(J.flexWrap="wrap"),!T&&P&&(J.columnGap=w),!O&&R&&(J.rowGap=C),A(i.createElement("div",Object.assign({ref:e,className:D,style:Object.assign(Object.assign(Object.assign({},J),c),$)},_),i.createElement(Yi,{value:L},K)))}),No=Zi;No.Compact=ci;var Qi=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]]);return n};const Mo=t=>{const{getPopupContainer:e,getPrefixCls:n,direction:o}=i.useContext(Ae),{prefixCls:r,type:s="default",danger:a,disabled:c,loading:l,onClick:d,htmlType:f,children:u,className:m,menu:p,arrow:h,autoFocus:g,overlay:x,trigger:v,align:$,open:I,onOpenChange:S,placement:y,getPopupContainer:_,href:w,icon:C=i.createElement(vn,null),title:O,buttonsRender:T=ne=>ne,mouseEnterDelay:R,mouseLeaveDelay:P,overlayClassName:M,overlayStyle:E,destroyOnHidden:N,destroyPopupOnHide:A,dropdownRender:B,popupRender:k}=t,D=Qi(t,["prefixCls","type","danger","disabled","loading","onClick","htmlType","children","className","menu","arrow","autoFocus","overlay","trigger","align","open","onOpenChange","placement","getPopupContainer","href","icon","title","buttonsRender","mouseEnterDelay","mouseLeaveDelay","overlayClassName","overlayStyle","destroyOnHidden","destroyPopupOnHide","dropdownRender","popupRender"]),q=n("dropdown",r),G=`${q}-button`,L={menu:p,arrow:h,autoFocus:g,align:$,disabled:c,trigger:c?[]:v,onOpenChange:S,getPopupContainer:_||e,mouseEnterDelay:R,mouseLeaveDelay:P,overlayClassName:M,overlayStyle:E,destroyOnHidden:N,popupRender:k||B},{compactSize:J,compactItemClassnames:Z}=ui(q,o),X=U(G,Z,m);"destroyPopupOnHide"in t&&(L.destroyPopupOnHide=A),"overlay"in t&&(L.overlay=x),"open"in t&&(L.open=I),"placement"in t?L.placement=y:L.placement=o==="rtl"?"bottomLeft":"bottomRight";const oe=i.createElement(xe,{type:s,danger:a,disabled:c,loading:l,onClick:d,htmlType:f,href:w,title:O},u),F=i.createElement(xe,{type:s,danger:a,icon:C}),[re,te]=T([oe,F]);return i.createElement(No.Compact,Object.assign({className:X,size:J,block:!0},D),re,i.createElement(jt,Object.assign({},L),te))};Mo.__ANT_BUTTON=!0;const Po=jt;Po.Button=Mo;var Ji={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM504 618H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8zM312 490v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8z"}}]},name:"file-text",theme:"outlined"},es=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:Ji}))},ts=i.forwardRef(es);function Bo(){var t=document.documentElement.clientWidth,e=window.innerHeight||document.documentElement.clientHeight;return{width:t,height:e}}function ns(t){var e=t.getBoundingClientRect(),n=document.documentElement;return{left:e.left+(window.pageXOffset||n.scrollLeft)-(n.clientLeft||document.body.clientLeft||0),top:e.top+(window.pageYOffset||n.scrollTop)-(n.clientTop||document.body.clientTop||0)}}function Ue(t,e,n,o){var r=Nn.unstable_batchedUpdates?function(a){Nn.unstable_batchedUpdates(n,a)}:n;return t!=null&&t.addEventListener&&t.addEventListener(e,r,o),{remove:function(){t!=null&&t.removeEventListener&&t.removeEventListener(e,r,o)}}}var mt=i.createContext(null),os=function(e){var n=e.visible,o=e.maskTransitionName,r=e.getContainer,s=e.prefixCls,a=e.rootClassName,c=e.icons,l=e.countRender,d=e.showSwitch,f=e.showProgress,u=e.current,m=e.transform,p=e.count,h=e.scale,g=e.minScale,x=e.maxScale,v=e.closeIcon,$=e.onActive,I=e.onClose,S=e.onZoomIn,y=e.onZoomOut,_=e.onRotateRight,w=e.onRotateLeft,C=e.onFlipX,O=e.onFlipY,T=e.onReset,R=e.toolbarRender,P=e.zIndex,M=e.image,E=i.useContext(mt),N=c.rotateLeft,A=c.rotateRight,B=c.zoomIn,k=c.zoomOut,D=c.close,q=c.left,G=c.right,K=c.flipX,L=c.flipY,J="".concat(s,"-operations-operation");i.useEffect(function(){var ee=function(Q){Q.keyCode===ct.ESC&&I()};return n&&window.addEventListener("keydown",ee),function(){window.removeEventListener("keydown",ee)}},[n]);var Z=function(z,Q){z.preventDefault(),z.stopPropagation(),$(Q)},X=i.useCallback(function(ee){var z=ee.type,Q=ee.disabled,fe=ee.onClick,ce=ee.icon;return i.createElement("div",{key:z,className:U(J,"".concat(s,"-operations-operation-").concat(z),Re({},"".concat(s,"-operations-operation-disabled"),!!Q)),onClick:fe},ce)},[J,s]),oe=d?X({icon:q,onClick:function(z){return Z(z,-1)},type:"prev",disabled:u===0}):void 0,F=d?X({icon:G,onClick:function(z){return Z(z,1)},type:"next",disabled:u===p-1}):void 0,re=X({icon:L,onClick:O,type:"flipY"}),te=X({icon:K,onClick:C,type:"flipX"}),ne=X({icon:N,onClick:w,type:"rotateLeft"}),Y=X({icon:A,onClick:_,type:"rotateRight"}),ie=X({icon:k,onClick:y,type:"zoomOut",disabled:h<=g}),he=X({icon:B,onClick:S,type:"zoomIn",disabled:h===x}),se=i.createElement("div",{className:"".concat(s,"-operations")},re,te,ne,Y,ie,he);return i.createElement(xr,{visible:n,motionName:o},function(ee){var z=ee.className,Q=ee.style;return i.createElement(di,{open:!0,getContainer:r??document.body},i.createElement("div",{className:U("".concat(s,"-operations-wrapper"),z,a),style:le(le({},Q),{},{zIndex:P})},v===null?null:i.createElement("button",{className:"".concat(s,"-close"),onClick:I},v||D),d&&i.createElement(i.Fragment,null,i.createElement("div",{className:U("".concat(s,"-switch-left"),Re({},"".concat(s,"-switch-left-disabled"),u===0)),onClick:function(ce){return Z(ce,-1)}},q),i.createElement("div",{className:U("".concat(s,"-switch-right"),Re({},"".concat(s,"-switch-right-disabled"),u===p-1)),onClick:function(ce){return Z(ce,1)}},G)),i.createElement("div",{className:"".concat(s,"-footer")},f&&i.createElement("div",{className:"".concat(s,"-progress")},l?l(u+1,p):i.createElement("bdi",null,"".concat(u+1," / ").concat(p))),R?R(se,le(le({icons:{prevIcon:oe,nextIcon:F,flipYIcon:re,flipXIcon:te,rotateLeftIcon:ne,rotateRightIcon:Y,zoomOutIcon:ie,zoomInIcon:he},actions:{onActive:$,onFlipY:O,onFlipX:C,onRotateLeft:w,onRotateRight:_,onZoomOut:y,onZoomIn:S,onReset:T,onClose:I},transform:m},E?{current:u,total:p}:{}),{},{image:M})):se)))})},ht={x:0,y:0,rotate:0,scale:1,flipX:!1,flipY:!1};function rs(t,e,n,o){var r=i.useRef(null),s=i.useRef([]),a=i.useState(ht),c=pe(a,2),l=c[0],d=c[1],f=function(h){d(ht),wr(ht,l)||o?.({transform:ht,action:h})},u=function(h,g){r.current===null&&(s.current=[],r.current=Cr(function(){d(function(x){var v=x;return s.current.forEach(function($){v=le(le({},v),$)}),r.current=null,o?.({transform:v,action:g}),v})})),s.current.push(le(le({},l),h))},m=function(h,g,x,v,$){var I=t.current,S=I.width,y=I.height,_=I.offsetWidth,w=I.offsetHeight,C=I.offsetLeft,O=I.offsetTop,T=h,R=l.scale*h;R>n?(R=n,T=n/l.scale):R<e&&(R=$?R:e,T=R/l.scale);var P=x??innerWidth/2,M=v??innerHeight/2,E=T-1,N=E*S*.5,A=E*y*.5,B=E*(P-l.x-C),k=E*(M-l.y-O),D=l.x-(B-N),q=l.y-(k-A);if(h<1&&R===1){var G=_*R,K=w*R,L=Bo(),J=L.width,Z=L.height;G<=J&&K<=Z&&(D=0,q=0)}u({x:D,y:q,scale:R},g)};return{transform:l,resetTransform:f,updateTransform:u,dispatchZoomChange:m}}function qn(t,e,n,o){var r=e+n,s=(n-o)/2;if(n>o){if(e>0)return Re({},t,s);if(e<0&&r<o)return Re({},t,-s)}else if(e<0||r>o)return Re({},t,e<0?s:-s);return{}}function ko(t,e,n,o){var r=Bo(),s=r.width,a=r.height,c=null;return t<=s&&e<=a?c={x:0,y:0}:(t>s||e>a)&&(c=le(le({},qn("x",n,t,s)),qn("y",o,e,a))),c}var We=1,is=1;function ss(t,e,n,o,r,s,a){var c=r.rotate,l=r.scale,d=r.x,f=r.y,u=i.useState(!1),m=pe(u,2),p=m[0],h=m[1],g=i.useRef({diffX:0,diffY:0,transformX:0,transformY:0}),x=function(y){!e||y.button!==0||(y.preventDefault(),y.stopPropagation(),g.current={diffX:y.pageX-d,diffY:y.pageY-f,transformX:d,transformY:f},h(!0))},v=function(y){n&&p&&s({x:y.pageX-g.current.diffX,y:y.pageY-g.current.diffY},"move")},$=function(){if(n&&p){h(!1);var y=g.current,_=y.transformX,w=y.transformY,C=d!==_&&f!==w;if(!C)return;var O=t.current.offsetWidth*l,T=t.current.offsetHeight*l,R=t.current.getBoundingClientRect(),P=R.left,M=R.top,E=c%180!==0,N=ko(E?T:O,E?O:T,P,M);N&&s(le({},N),"dragRebound")}},I=function(y){if(!(!n||y.deltaY==0)){var _=Math.abs(y.deltaY/100),w=Math.min(_,is),C=We+w*o;y.deltaY>0&&(C=We/C),a(C,"wheel",y.clientX,y.clientY)}};return i.useEffect(function(){var S,y,_,w;if(e){_=Ue(window,"mouseup",$,!1),w=Ue(window,"mousemove",v,!1);try{window.top!==window.self&&(S=Ue(window.top,"mouseup",$,!1),y=Ue(window.top,"mousemove",v,!1))}catch{}}return function(){var C,O,T,R;(C=_)===null||C===void 0||C.remove(),(O=w)===null||O===void 0||O.remove(),(T=S)===null||T===void 0||T.remove(),(R=y)===null||R===void 0||R.remove()}},[n,p,d,f,c,e]),{isMoving:p,onMouseDown:x,onMouseMove:v,onMouseUp:$,onWheel:I}}function as(t){return new Promise(function(e){if(!t){e(!1);return}var n=document.createElement("img");n.onerror=function(){return e(!1)},n.onload=function(){return e(!0)},n.src=t})}function Ao(t){var e=t.src,n=t.isCustomPlaceholder,o=t.fallback,r=i.useState(n?"loading":"normal"),s=pe(r,2),a=s[0],c=s[1],l=i.useRef(!1),d=a==="error";i.useEffect(function(){var p=!0;return as(e).then(function(h){!h&&p&&c("error")}),function(){p=!1}},[e]),i.useEffect(function(){n&&!l.current?c("loading"):d&&c("normal")},[e]);var f=function(){c("normal")},u=function(h){l.current=!1,a==="loading"&&h!==null&&h!==void 0&&h.complete&&(h.naturalWidth||h.naturalHeight)&&(l.current=!0,f())},m=d&&o?{src:o}:{onLoad:f,src:e};return[u,m,a]}function Tt(t,e){var n=t.x-e.x,o=t.y-e.y;return Math.hypot(n,o)}function ls(t,e,n,o){var r=Tt(t,n),s=Tt(e,o);if(r===0&&s===0)return[t.x,t.y];var a=r/(r+s),c=t.x+a*(e.x-t.x),l=t.y+a*(e.y-t.y);return[c,l]}function cs(t,e,n,o,r,s,a){var c=r.rotate,l=r.scale,d=r.x,f=r.y,u=i.useState(!1),m=pe(u,2),p=m[0],h=m[1],g=i.useRef({point1:{x:0,y:0},point2:{x:0,y:0},eventType:"none"}),x=function(y){g.current=le(le({},g.current),y)},v=function(y){if(e){y.stopPropagation(),h(!0);var _=y.touches,w=_===void 0?[]:_;w.length>1?x({point1:{x:w[0].clientX,y:w[0].clientY},point2:{x:w[1].clientX,y:w[1].clientY},eventType:"touchZoom"}):x({point1:{x:w[0].clientX-d,y:w[0].clientY-f},eventType:"move"})}},$=function(y){var _=y.touches,w=_===void 0?[]:_,C=g.current,O=C.point1,T=C.point2,R=C.eventType;if(w.length>1&&R==="touchZoom"){var P={x:w[0].clientX,y:w[0].clientY},M={x:w[1].clientX,y:w[1].clientY},E=ls(O,T,P,M),N=pe(E,2),A=N[0],B=N[1],k=Tt(P,M)/Tt(O,T);a(k,"touchZoom",A,B,!0),x({point1:P,point2:M,eventType:"touchZoom"})}else R==="move"&&(s({x:w[0].clientX-O.x,y:w[0].clientY-O.y},"move"),x({eventType:"move"}))},I=function(){if(n){if(p&&h(!1),x({eventType:"none"}),o>l)return s({x:0,y:0,scale:o},"touchZoom");var y=t.current.offsetWidth*l,_=t.current.offsetHeight*l,w=t.current.getBoundingClientRect(),C=w.left,O=w.top,T=c%180!==0,R=ko(T?_:y,T?y:_,C,O);R&&s(le({},R),"dragRebound")}};return i.useEffect(function(){var S;return n&&e&&(S=Ue(window,"touchmove",function(y){return y.preventDefault()},{passive:!1})),function(){var y;(y=S)===null||y===void 0||y.remove()}},[n,e]),{isTouching:p,onTouchStart:v,onTouchMove:$,onTouchEnd:I}}var us=["fallback","src","imgRef"],ds=["prefixCls","src","alt","imageInfo","fallback","movable","onClose","visible","icons","rootClassName","closeIcon","getContainer","current","count","countRender","scaleStep","minScale","maxScale","transitionName","maskTransitionName","imageRender","imgCommonProps","toolbarRender","onTransform","onChange"],fs=function(e){var n=e.fallback,o=e.src,r=e.imgRef,s=Xe(e,us),a=Ao({src:o,fallback:n}),c=pe(a,2),l=c[0],d=c[1];return Le.createElement("img",ae({ref:function(u){r.current=u,l(u)}},s,d))},jo=function(e){var n=e.prefixCls,o=e.src,r=e.alt,s=e.imageInfo,a=e.fallback,c=e.movable,l=c===void 0?!0:c,d=e.onClose,f=e.visible,u=e.icons,m=u===void 0?{}:u,p=e.rootClassName,h=e.closeIcon,g=e.getContainer,x=e.current,v=x===void 0?0:x,$=e.count,I=$===void 0?1:$,S=e.countRender,y=e.scaleStep,_=y===void 0?.5:y,w=e.minScale,C=w===void 0?1:w,O=e.maxScale,T=O===void 0?50:O,R=e.transitionName,P=R===void 0?"zoom":R,M=e.maskTransitionName,E=M===void 0?"fade":M,N=e.imageRender,A=e.imgCommonProps,B=e.toolbarRender,k=e.onTransform,D=e.onChange,q=Xe(e,ds),G=i.useRef(),K=i.useContext(mt),L=K&&I>1,J=K&&I>=1,Z=i.useState(!0),X=pe(Z,2),oe=X[0],F=X[1],re=rs(G,C,T,k),te=re.transform,ne=re.resetTransform,Y=re.updateTransform,ie=re.dispatchZoomChange,he=ss(G,l,f,_,te,Y,ie),se=he.isMoving,ee=he.onMouseDown,z=he.onWheel,Q=cs(G,l,f,C,te,Y,ie),fe=Q.isTouching,ce=Q.onTouchStart,Ee=Q.onTouchMove,Me=Q.onTouchEnd,ve=te.rotate,$e=te.scale,He=U(Re({},"".concat(n,"-moving"),se));i.useEffect(function(){oe||F(!0)},[oe]);var nt=function(){ne("close")},ot=function(){ie(We+_,"zoomIn")},Ie=function(){ie(We/(We+_),"zoomOut")},be=function(){Y({rotate:ve+90},"rotateRight")},Pe=function(){Y({rotate:ve-90},"rotateLeft")},Fe=function(){Y({flipX:!te.flipX},"flipX")},Ve=function(){Y({flipY:!te.flipY},"flipY")},Vt=function(){ne("reset")},rt=function(Te){var pt=v+Te;!Number.isInteger(pt)||pt<0||pt>I-1||(F(!1),ne(Te<0?"prev":"next"),D?.(pt,v))},Ut=function(Te){!f||!L||(Te.keyCode===ct.LEFT?rt(-1):Te.keyCode===ct.RIGHT&&rt(1))},j=function(Te){f&&($e!==1?Y({x:0,y:0,scale:1},"doubleClick"):ie(We+_,"doubleClick",Te.clientX,Te.clientY))};i.useEffect(function(){var ge=Ue(window,"keydown",Ut,!1);return function(){ge.remove()}},[f,L,v]);var V=Le.createElement(fs,ae({},A,{width:e.width,height:e.height,imgRef:G,className:"".concat(n,"-img"),alt:r,style:{transform:"translate3d(".concat(te.x,"px, ").concat(te.y,"px, 0) scale3d(").concat(te.flipX?"-":"").concat($e,", ").concat(te.flipY?"-":"").concat($e,", 1) rotate(").concat(ve,"deg)"),transitionDuration:(!oe||fe)&&"0s"},fallback:a,src:o,onWheel:z,onMouseDown:ee,onDoubleClick:j,onTouchStart:ce,onTouchMove:Ee,onTouchEnd:Me,onTouchCancel:Me})),ye=le({url:o,alt:r},s);return Le.createElement(Le.Fragment,null,Le.createElement(jr,ae({transitionName:P,maskTransitionName:E,closable:!1,keyboard:!0,prefixCls:n,onClose:d,visible:f,classNames:{wrapper:He},rootClassName:p,getContainer:g},q,{afterClose:nt}),Le.createElement("div",{className:"".concat(n,"-img-wrapper")},N?N(V,le({transform:te,image:ye},K?{current:v}:{})):V)),Le.createElement(os,{visible:f,transform:te,maskTransitionName:E,closeIcon:h,getContainer:g,prefixCls:n,rootClassName:p,icons:m,countRender:S,showSwitch:L,showProgress:J,current:v,count:I,scale:$e,minScale:C,maxScale:T,toolbarRender:B,onActive:rt,onZoomIn:ot,onZoomOut:Ie,onRotateRight:be,onRotateLeft:Pe,onFlipX:Fe,onFlipY:Ve,onClose:d,onReset:Vt,zIndex:q.zIndex!==void 0?q.zIndex+1:void 0,image:ye}))},rn=["crossOrigin","decoding","draggable","loading","referrerPolicy","sizes","srcSet","useMap","alt"];function ms(t){var e=i.useState({}),n=pe(e,2),o=n[0],r=n[1],s=i.useCallback(function(c,l){return r(function(d){return le(le({},d),{},Re({},c,l))}),function(){r(function(d){var f=le({},d);return delete f[c],f})}},[]),a=i.useMemo(function(){return t?t.map(function(c){if(typeof c=="string")return{data:{src:c}};var l={};return Object.keys(c).forEach(function(d){["src"].concat(Nt(rn)).includes(d)&&(l[d]=c[d])}),{data:l}}):Object.keys(o).reduce(function(c,l){var d=o[l],f=d.canPreview,u=d.data;return f&&c.push({data:u,id:l}),c},[])},[t,o]);return[a,s,!!t]}var ps=["visible","onVisibleChange","getContainer","current","movable","minScale","maxScale","countRender","closeIcon","onChange","onTransform","toolbarRender","imageRender"],hs=["src"],gs=function(e){var n,o=e.previewPrefixCls,r=o===void 0?"rc-image-preview":o,s=e.children,a=e.icons,c=a===void 0?{}:a,l=e.items,d=e.preview,f=e.fallback,u=mo(d)==="object"?d:{},m=u.visible,p=u.onVisibleChange,h=u.getContainer,g=u.current,x=u.movable,v=u.minScale,$=u.maxScale,I=u.countRender,S=u.closeIcon,y=u.onChange,_=u.onTransform,w=u.toolbarRender,C=u.imageRender,O=Xe(u,ps),T=ms(l),R=pe(T,3),P=R[0],M=R[1],E=R[2],N=Ke(0,{value:g}),A=pe(N,2),B=A[0],k=A[1],D=i.useState(!1),q=pe(D,2),G=q[0],K=q[1],L=((n=P[B])===null||n===void 0?void 0:n.data)||{},J=L.src,Z=Xe(L,hs),X=Ke(!!m,{value:m,onChange:function(fe,ce){p?.(fe,ce,B)}}),oe=pe(X,2),F=oe[0],re=oe[1],te=i.useState(null),ne=pe(te,2),Y=ne[0],ie=ne[1],he=i.useCallback(function(Q,fe,ce,Ee){var Me=E?P.findIndex(function(ve){return ve.data.src===fe}):P.findIndex(function(ve){return ve.id===Q});k(Me<0?0:Me),re(!0),ie({x:ce,y:Ee}),K(!0)},[P,E]);i.useEffect(function(){F?G||k(0):K(!1)},[F]);var se=function(fe,ce){k(fe),y?.(fe,ce)},ee=function(){re(!1),ie(null)},z=i.useMemo(function(){return{register:M,onPreview:he}},[M,he]);return i.createElement(mt.Provider,{value:z},s,i.createElement(jo,ae({"aria-hidden":!F,movable:x,visible:F,prefixCls:r,closeIcon:S,onClose:ee,mousePosition:Y,imgCommonProps:Z,src:J,fallback:f,icons:c,minScale:v,maxScale:$,getContainer:h,current:B,count:P.length,countRender:I,onTransform:_,toolbarRender:w,imageRender:C,onChange:se},O)))},Xn=0;function vs(t,e){var n=i.useState(function(){return Xn+=1,String(Xn)}),o=pe(n,1),r=o[0],s=i.useContext(mt),a={data:e,canPreview:t};return i.useEffect(function(){if(s)return s.register(r,a)},[]),i.useEffect(function(){s&&s.register(r,a)},[t,e]),r}var ys=["src","alt","onPreviewClose","prefixCls","previewPrefixCls","placeholder","fallback","width","height","style","preview","className","onClick","onError","wrapperClassName","wrapperStyle","rootClassName"],bs=["src","visible","onVisibleChange","getContainer","mask","maskClassName","movable","icons","scaleStep","minScale","maxScale","imageRender","toolbarRender"],xn=function(e){var n=e.src,o=e.alt,r=e.onPreviewClose,s=e.prefixCls,a=s===void 0?"rc-image":s,c=e.previewPrefixCls,l=c===void 0?"".concat(a,"-preview"):c,d=e.placeholder,f=e.fallback,u=e.width,m=e.height,p=e.style,h=e.preview,g=h===void 0?!0:h,x=e.className,v=e.onClick,$=e.onError,I=e.wrapperClassName,S=e.wrapperStyle,y=e.rootClassName,_=Xe(e,ys),w=d&&d!==!0,C=mo(g)==="object"?g:{},O=C.src,T=C.visible,R=T===void 0?void 0:T,P=C.onVisibleChange,M=P===void 0?r:P,E=C.getContainer,N=E===void 0?void 0:E,A=C.mask,B=C.maskClassName,k=C.movable,D=C.icons,q=C.scaleStep,G=C.minScale,K=C.maxScale,L=C.imageRender,J=C.toolbarRender,Z=Xe(C,bs),X=O??n,oe=Ke(!!R,{value:R,onChange:M}),F=pe(oe,2),re=F[0],te=F[1],ne=Ao({src:n,isCustomPlaceholder:w,fallback:f}),Y=pe(ne,3),ie=Y[0],he=Y[1],se=Y[2],ee=i.useState(null),z=pe(ee,2),Q=z[0],fe=z[1],ce=i.useContext(mt),Ee=!!g,Me=function(){te(!1),fe(null)},ve=U(a,I,y,Re({},"".concat(a,"-error"),se==="error")),$e=i.useMemo(function(){var Ie={};return rn.forEach(function(be){e[be]!==void 0&&(Ie[be]=e[be])}),Ie},rn.map(function(Ie){return e[Ie]})),He=i.useMemo(function(){return le(le({},$e),{},{src:X})},[X,$e]),nt=vs(Ee,He),ot=function(be){var Pe=ns(be.target),Fe=Pe.left,Ve=Pe.top;ce?ce.onPreview(nt,X,Fe,Ve):(fe({x:Fe,y:Ve}),te(!0)),v?.(be)};return i.createElement(i.Fragment,null,i.createElement("div",ae({},_,{className:ve,onClick:Ee?ot:v,style:le({width:u,height:m},S)}),i.createElement("img",ae({},$e,{className:U("".concat(a,"-img"),Re({},"".concat(a,"-img-placeholder"),d===!0),x),style:le({height:m},p),ref:ie},he,{width:u,height:m,onError:$})),se==="loading"&&i.createElement("div",{"aria-hidden":"true",className:"".concat(a,"-placeholder")},d),A&&Ee&&i.createElement("div",{className:U("".concat(a,"-mask"),B),style:{display:p?.display==="none"?"none":void 0}},A)),!ce&&Ee&&i.createElement(jo,ae({"aria-hidden":!re,visible:re,prefixCls:l,onClose:Me,mousePosition:Q,src:X,alt:o,imageInfo:{width:u,height:m},fallback:f,getContainer:N,icons:D,movable:k,scaleStep:q,minScale:G,maxScale:K,rootClassName:y,imageRender:L,imgCommonProps:$e,toolbarRender:J},Z)))};xn.PreviewGroup=gs;var xs={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M672 418H144c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32zm-44 402H188V494h440v326z"}},{tag:"path",attrs:{d:"M819.3 328.5c-78.8-100.7-196-153.6-314.6-154.2l-.2-64c0-6.5-7.6-10.1-12.6-6.1l-128 101c-4 3.1-3.9 9.1 0 12.3L492 318.6c5.1 4 12.7.4 12.6-6.1v-63.9c12.9.1 25.9.9 38.8 2.5 42.1 5.2 82.1 18.2 119 38.7 38.1 21.2 71.2 49.7 98.4 84.3 27.1 34.7 46.7 73.7 58.1 115.8a325.95 325.95 0 016.5 140.9h74.9c14.8-103.6-11.3-213-81-302.3z"}}]},name:"rotate-left",theme:"outlined"},ws=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:xs}))},Cs=i.forwardRef(ws),Ss={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M480.5 251.2c13-1.6 25.9-2.4 38.8-2.5v63.9c0 6.5 7.5 10.1 12.6 6.1L660 217.6c4-3.2 4-9.2 0-12.3l-128-101c-5.1-4-12.6-.4-12.6 6.1l-.2 64c-118.6.5-235.8 53.4-314.6 154.2A399.75 399.75 0 00123.5 631h74.9c-.9-5.3-1.7-10.7-2.4-16.1-5.1-42.1-2.1-84.1 8.9-124.8 11.4-42.2 31-81.1 58.1-115.8 27.2-34.7 60.3-63.2 98.4-84.3 37-20.6 76.9-33.6 119.1-38.8z"}},{tag:"path",attrs:{d:"M880 418H352c-17.7 0-32 14.3-32 32v414c0 17.7 14.3 32 32 32h528c17.7 0 32-14.3 32-32V450c0-17.7-14.3-32-32-32zm-44 402H396V494h440v326z"}}]},name:"rotate-right",theme:"outlined"},Es=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:Ss}))},$s=i.forwardRef(Es),Os={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M847.9 592H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h605.2L612.9 851c-4.1 5.2-.4 13 6.3 13h72.5c4.9 0 9.5-2.2 12.6-6.1l168.8-214.1c16.5-21 1.6-51.8-25.2-51.8zM872 356H266.8l144.3-183c4.1-5.2.4-13-6.3-13h-72.5c-4.9 0-9.5 2.2-12.6 6.1L150.9 380.2c-16.5 21-1.6 51.8 25.1 51.8h696c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"swap",theme:"outlined"},Is=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:Os}))},Yn=i.forwardRef(Is),Ts={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M637 443H519V309c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v134H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h118v134c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V519h118c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"}}]},name:"zoom-in",theme:"outlined"},Rs=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:Ts}))},_s=i.forwardRef(Rs),Ns={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M637 443H325c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h312c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8zm284 424L775 721c122.1-148.9 113.6-369.5-26-509-148-148.1-388.4-148.1-537 0-148.1 148.6-148.1 389 0 537 139.5 139.6 360.1 148.1 509 26l146 146c3.2 2.8 8.3 2.8 11 0l43-43c2.8-2.7 2.8-7.8 0-11zM696 696c-118.8 118.7-311.2 118.7-430 0-118.7-118.8-118.7-311.2 0-430 118.8-118.7 311.2-118.7 430 0 118.7 118.8 118.7 311.2 0 430z"}}]},name:"zoom-out",theme:"outlined"},Ms=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:Ns}))},Ps=i.forwardRef(Ms);const sn=t=>({position:t||"absolute",inset:0}),Bs=t=>{const{iconCls:e,motionDurationSlow:n,paddingXXS:o,marginXXS:r,prefixCls:s,colorTextLightSolid:a}=t;return{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",color:a,background:new Be("#000").setA(.5).toRgbString(),cursor:"pointer",opacity:0,transition:`opacity ${n}`,[`.${s}-mask-info`]:Object.assign(Object.assign({},uo),{padding:`0 ${H(o)}`,[e]:{marginInlineEnd:r,svg:{verticalAlign:"baseline"}}})}},ks=t=>{const{previewCls:e,modalMaskBg:n,paddingSM:o,marginXL:r,margin:s,paddingLG:a,previewOperationColorDisabled:c,previewOperationHoverColor:l,motionDurationSlow:d,iconCls:f,colorTextLightSolid:u}=t,m=new Be(n).setA(.1),p=m.clone().setA(.2);return{[`${e}-footer`]:{position:"fixed",bottom:r,left:{_skip_check_:!0,value:"50%"},display:"flex",flexDirection:"column",alignItems:"center",color:t.previewOperationColor,transform:"translateX(-50%)"},[`${e}-progress`]:{marginBottom:s},[`${e}-close`]:{position:"fixed",top:r,right:{_skip_check_:!0,value:r},display:"flex",color:u,backgroundColor:m.toRgbString(),borderRadius:"50%",padding:o,outline:0,border:0,cursor:"pointer",transition:`all ${d}`,"&:hover":{backgroundColor:p.toRgbString()},[`& > ${f}`]:{fontSize:t.previewOperationSize}},[`${e}-operations`]:{display:"flex",alignItems:"center",padding:`0 ${H(a)}`,backgroundColor:m.toRgbString(),borderRadius:100,"&-operation":{marginInlineStart:o,padding:o,cursor:"pointer",transition:`all ${d}`,userSelect:"none",[`&:not(${e}-operations-operation-disabled):hover > ${f}`]:{color:l},"&-disabled":{color:c,cursor:"not-allowed"},"&:first-of-type":{marginInlineStart:0},[`& > ${f}`]:{fontSize:t.previewOperationSize}}}}},As=t=>{const{modalMaskBg:e,iconCls:n,previewOperationColorDisabled:o,previewCls:r,zIndexPopup:s,motionDurationSlow:a}=t,c=new Be(e).setA(.1),l=c.clone().setA(.2);return{[`${r}-switch-left, ${r}-switch-right`]:{position:"fixed",insetBlockStart:"50%",zIndex:t.calc(s).add(1).equal(),display:"flex",alignItems:"center",justifyContent:"center",width:t.imagePreviewSwitchSize,height:t.imagePreviewSwitchSize,marginTop:t.calc(t.imagePreviewSwitchSize).mul(-1).div(2).equal(),color:t.previewOperationColor,background:c.toRgbString(),borderRadius:"50%",transform:"translateY(-50%)",cursor:"pointer",transition:`all ${a}`,userSelect:"none","&:hover":{background:l.toRgbString()},"&-disabled":{"&, &:hover":{color:o,background:"transparent",cursor:"not-allowed",[`> ${n}`]:{cursor:"not-allowed"}}},[`> ${n}`]:{fontSize:t.previewOperationSize}},[`${r}-switch-left`]:{insetInlineStart:t.marginSM},[`${r}-switch-right`]:{insetInlineEnd:t.marginSM}}},js=t=>{const{motionEaseOut:e,previewCls:n,motionDurationSlow:o,componentCls:r}=t;return[{[`${r}-preview-root`]:{[n]:{height:"100%",textAlign:"center",pointerEvents:"none"},[`${n}-body`]:Object.assign(Object.assign({},sn()),{overflow:"hidden"}),[`${n}-img`]:{maxWidth:"100%",maxHeight:"70%",verticalAlign:"middle",transform:"scale3d(1, 1, 1)",cursor:"grab",transition:`transform ${o} ${e} 0s`,userSelect:"none","&-wrapper":Object.assign(Object.assign({},sn()),{transition:`transform ${o} ${e} 0s`,display:"flex",justifyContent:"center",alignItems:"center","& > *":{pointerEvents:"auto"},"&::before":{display:"inline-block",width:1,height:"50%",marginInlineEnd:-1,content:'""'}})},[`${n}-moving`]:{[`${n}-preview-img`]:{cursor:"grabbing","&-wrapper":{transitionDuration:"0s"}}}}},{[`${r}-preview-root`]:{[`${n}-wrap`]:{zIndex:t.zIndexPopup}}},{[`${r}-preview-operations-wrapper`]:{position:"fixed",zIndex:t.calc(t.zIndexPopup).add(1).equal()},"&":[ks(t),As(t)]}]},Ls=t=>{const{componentCls:e}=t;return{[e]:{position:"relative",display:"inline-block",[`${e}-img`]:{width:"100%",height:"auto",verticalAlign:"middle"},[`${e}-img-placeholder`]:{backgroundColor:t.colorBgContainerDisabled,backgroundImage:"url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMTQuNSAyLjVoLTEzQS41LjUgMCAwIDAgMSAzdjEwYS41LjUgMCAwIDAgLjUuNWgxM2EuNS41IDAgMCAwIC41LS41VjNhLjUuNSAwIDAgMC0uNS0uNXpNNS4yODEgNC43NWExIDEgMCAwIDEgMCAyIDEgMSAwIDAgMSAwLTJ6bTguMDMgNi44M2EuMTI3LjEyNyAwIDAgMS0uMDgxLjAzSDIuNzY5YS4xMjUuMTI1IDAgMCAxLS4wOTYtLjIwN2wyLjY2MS0zLjE1NmEuMTI2LjEyNiAwIDAgMSAuMTc3LS4wMTZsLjAxNi4wMTZMNy4wOCAxMC4wOWwyLjQ3LTIuOTNhLjEyNi4xMjYgMCAwIDEgLjE3Ny0uMDE2bC4wMTUuMDE2IDMuNTg4IDQuMjQ0YS4xMjcuMTI3IDAgMCAxLS4wMi4xNzV6IiBmaWxsPSIjOEM4QzhDIiBmaWxsLXJ1bGU9Im5vbnplcm8iLz48L3N2Zz4=')",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundSize:"30%"},[`${e}-mask`]:Object.assign({},Bs(t)),[`${e}-mask:hover`]:{opacity:1},[`${e}-placeholder`]:Object.assign({},sn())}}},zs=t=>{const{previewCls:e}=t;return{[`${e}-root`]:gn(t,"zoom"),"&":zr(t,!0)}},Ds=t=>({zIndexPopup:t.zIndexPopupBase+80,previewOperationColor:new Be(t.colorTextLightSolid).setA(.65).toRgbString(),previewOperationHoverColor:new Be(t.colorTextLightSolid).setA(.85).toRgbString(),previewOperationColorDisabled:new Be(t.colorTextLightSolid).setA(.25).toRgbString(),previewOperationSize:t.fontSizeIcon*1.5}),Lo=Je("Image",t=>{const e=`${t.componentCls}-preview`,n=lt(t,{previewCls:e,modalMaskBg:new Be("#000").setA(.45).toRgbString(),imagePreviewSwitchSize:t.controlHeightLG});return[Ls(n),js(n),Lr(lt(n,{componentCls:e})),zs(n)]},Ds);var Hs=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]]);return n};const zo={rotateLeft:i.createElement(Cs,null),rotateRight:i.createElement($s,null),zoomIn:i.createElement(_s,null),zoomOut:i.createElement(Ps,null),close:i.createElement(fi,null),left:i.createElement(Ye,null),right:i.createElement(Ge,null),flipX:i.createElement(Yn,null),flipY:i.createElement(Yn,{rotate:90})},Fs=t=>{var{previewPrefixCls:e,preview:n}=t,o=Hs(t,["previewPrefixCls","preview"]);const{getPrefixCls:r,direction:s}=i.useContext(Ae),a=r("image",e),c=`${a}-preview`,l=r(),d=Bt(a),[f,u,m]=Lo(a,d),[p]=Pt("ImagePreview",typeof n=="object"?n.zIndex:void 0),h=i.useMemo(()=>Object.assign(Object.assign({},zo),{left:s==="rtl"?i.createElement(Ge,null):i.createElement(Ye,null),right:s==="rtl"?i.createElement(Ye,null):i.createElement(Ge,null)}),[s]),g=i.useMemo(()=>{var x;if(n===!1)return n;const v=typeof n=="object"?n:{},$=U(u,m,d,(x=v.rootClassName)!==null&&x!==void 0?x:"");return Object.assign(Object.assign({},v),{transitionName:$t(l,"zoom",v.transitionName),maskTransitionName:$t(l,"fade",v.maskTransitionName),rootClassName:$,zIndex:p})},[n]);return f(i.createElement(xn.PreviewGroup,Object.assign({preview:g,previewPrefixCls:c,icons:h},o)))};var Gn=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]]);return n};const Do=t=>{const{prefixCls:e,preview:n,className:o,rootClassName:r,style:s}=t,a=Gn(t,["prefixCls","preview","className","rootClassName","style"]),{getPrefixCls:c,getPopupContainer:l,className:d,style:f,preview:u}=_t("image"),[m]=yo("Image"),p=c("image",e),h=c(),g=Bt(p),[x,v,$]=Lo(p,g),I=U(r,v,$,g),S=U(o,v,d),[y]=Pt("ImagePreview",typeof n=="object"?n.zIndex:void 0),_=i.useMemo(()=>{if(n===!1)return n;const C=typeof n=="object"?n:{},{getContainer:O,closeIcon:T,rootClassName:R,destroyOnClose:P,destroyOnHidden:M}=C,E=Gn(C,["getContainer","closeIcon","rootClassName","destroyOnClose","destroyOnHidden"]);return Object.assign(Object.assign({mask:i.createElement("div",{className:`${p}-mask-info`},i.createElement(mi,null),m?.preview),icons:zo},E),{destroyOnClose:M??P,rootClassName:U(I,R),getContainer:O??l,transitionName:$t(h,"zoom",C.transitionName),maskTransitionName:$t(h,"fade",C.maskTransitionName),zIndex:y,closeIcon:T??u?.closeIcon})},[n,m,u?.closeIcon]),w=Object.assign(Object.assign({},f),s);return x(i.createElement(xn,Object.assign({prefixCls:p,preview:_,rootClassName:I,className:S,style:w},a)))};Do.PreviewGroup=Fs;function Vs(t,e,n){return typeof n=="boolean"?n:t.length?!0:dt(e).some(r=>r.type===Oo)}var Ho=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]]);return n};function Lt({suffixCls:t,tagName:e,displayName:n}){return o=>i.forwardRef((s,a)=>i.createElement(o,Object.assign({ref:a,suffixCls:t,tagName:e},s)))}const wn=i.forwardRef((t,e)=>{const{prefixCls:n,suffixCls:o,className:r,tagName:s}=t,a=Ho(t,["prefixCls","suffixCls","className","tagName"]),{getPrefixCls:c}=i.useContext(Ae),l=c("layout",n),[d,f,u]=$o(l),m=o?`${l}-${o}`:l;return d(i.createElement(s,Object.assign({className:U(n||m,r,f,u),ref:e},a)))}),Us=i.forwardRef((t,e)=>{const{direction:n}=i.useContext(Ae),[o,r]=i.useState([]),{prefixCls:s,className:a,rootClassName:c,children:l,hasSider:d,tagName:f,style:u}=t,m=Ho(t,["prefixCls","className","rootClassName","children","hasSider","tagName","style"]),p=De(m,["suffixCls"]),{getPrefixCls:h,className:g,style:x}=_t("layout"),v=h("layout",s),$=Vs(o,l,d),[I,S,y]=$o(v),_=U(v,{[`${v}-has-sider`]:$,[`${v}-rtl`]:n==="rtl"},g,a,c,S,y),w=i.useMemo(()=>({siderHook:{addSider:C=>{r(O=>[].concat(Nt(O),[C]))},removeSider:C=>{r(O=>O.filter(T=>T!==C))}}}),[]);return I(i.createElement(Co.Provider,{value:w},i.createElement(f,Object.assign({ref:e,className:_,style:Object.assign(Object.assign({},x),u)},p),l)))}),Ws=Lt({tagName:"div",displayName:"Layout"})(Us),qs=Lt({suffixCls:"header",tagName:"header",displayName:"Header"})(wn),Xs=Lt({suffixCls:"footer",tagName:"footer",displayName:"Footer"})(wn),Ys=Lt({suffixCls:"content",tagName:"main",displayName:"Content"})(wn),ke=Ws;ke.Header=qs;ke.Footer=Xs;ke.Content=Ys;ke.Sider=Oo;ke._InternalSiderContext=At;const Gs=(t,e=!1)=>e&&t==null?[]:Array.isArray(t)?t:[t];var Ks={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M862 465.3h-81c-4.6 0-9 2-12.1 5.5L550 723.1V160c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v563.1L255.1 470.8c-3-3.5-7.4-5.5-12.1-5.5h-81c-6.8 0-10.5 8.1-6 13.2L487.9 861a31.96 31.96 0 0048.3 0L868 478.5c4.5-5.2.8-13.2-6-13.2z"}}]},name:"arrow-down",theme:"outlined"},Zs=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:Ks}))},Qs=i.forwardRef(Zs),Js={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H286.9l350.2-304c5.6-4.9 2.2-14-5.2-14h-88.5c-3.9 0-7.6 1.4-10.5 3.9L155 487.8a31.96 31.96 0 000 48.3L535.1 866c1.5 1.3 3.3 2 5.2 2h91.5c7.4 0 10.8-9.2 5.2-14L286.9 550H872c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"arrow-left",theme:"outlined"},ea=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:Js}))},ta=i.forwardRef(ea),na={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M842 454c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 140.3-113.7 254-254 254S258 594.3 258 454c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 168.7 126.6 307.9 290 327.6V884H326.7c-13.7 0-24.7 14.3-24.7 32v36c0 4.4 2.8 8 6.2 8h407.6c3.4 0 6.2-3.6 6.2-8v-36c0-17.7-11-32-24.7-32H548V782.1c165.3-18 294-158 294-328.1zM512 624c93.9 0 170-75.2 170-168V232c0-92.8-76.1-168-170-168s-170 75.2-170 168v224c0 92.8 76.1 168 170 168zm-94-392c0-50.6 41.9-92 94-92s94 41.4 94 92v224c0 50.6-41.9 92-94 92s-94-41.4-94-92V232z"}}]},name:"audio",theme:"outlined"},oa=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:na}))},ra=i.forwardRef(oa),ia={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"},sa=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:ia}))},aa=i.forwardRef(sa),la={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},ca=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:la}))},Kn=i.forwardRef(ca),ua={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M257.7 752c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9zm67.4-174.4L687.8 215l73.3 73.3-362.7 362.6-88.9 15.7 15.6-89zM880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32z"}}]},name:"edit",theme:"outlined"},da=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:ua}))},fa=i.forwardRef(da),ma={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 170h-60c-4.4 0-8 3.6-8 8v518H310v-73c0-6.7-7.8-10.5-13-6.3l-141.9 112a8 8 0 000 12.6l141.9 112c5.3 4.2 13 .4 13-6.3v-75h498c35.3 0 64-28.7 64-64V178c0-4.4-3.6-8-8-8z"}}]},name:"enter",theme:"outlined"},pa=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:ma}))},ha=i.forwardRef(pa),ga={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M779.3 196.6c-94.2-94.2-247.6-94.2-341.7 0l-261 260.8c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l261-260.8c32.4-32.4 75.5-50.2 121.3-50.2s88.9 17.8 121.2 50.2c32.4 32.4 50.2 75.5 50.2 121.2 0 45.8-17.8 88.8-50.2 121.2l-266 265.9-43.1 43.1c-40.3 40.3-105.8 40.3-146.1 0-19.5-19.5-30.2-45.4-30.2-73s10.7-53.5 30.2-73l263.9-263.8c6.7-6.6 15.5-10.3 24.9-10.3h.1c9.4 0 18.1 3.7 24.7 10.3 6.7 6.7 10.3 15.5 10.3 24.9 0 9.3-3.7 18.1-10.3 24.7L372.4 653c-1.7 1.7-2.6 4-2.6 6.4s.9 4.7 2.6 6.4l36.9 36.9a9 9 0 0012.7 0l215.6-215.6c19.9-19.9 30.8-46.3 30.8-74.4s-11-54.6-30.8-74.4c-41.1-41.1-107.9-41-149 0L463 364 224.8 602.1A172.22 172.22 0 00174 724.8c0 46.3 18.1 89.8 50.8 122.5 33.9 33.8 78.3 50.7 122.7 50.7 44.4 0 88.8-16.9 122.6-50.7l309.2-309C824.8 492.7 850 432 850 367.5c.1-64.6-25.1-125.3-70.7-170.9z"}}]},name:"paper-clip",theme:"outlined"},va=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:ga}))},ya=i.forwardRef(va),ba={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M304 176h80v672h-80zm408 0h-64c-4.4 0-8 3.6-8 8v656c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V184c0-4.4-3.6-8-8-8z"}}]},name:"pause",theme:"outlined"},xa=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:ba}))},wa=i.forwardRef(xa),Ca={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M719.4 499.1l-296.1-215A15.9 15.9 0 00398 297v430c0 13.1 14.8 20.5 25.3 12.9l296.1-215a15.9 15.9 0 000-25.8zm-257.6 134V390.9L628.5 512 461.8 633.1z"}}]},name:"play-circle",theme:"outlined"},Sa=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:Ca}))},Ea=i.forwardRef(Sa),$a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M931.4 498.9L94.9 79.5c-3.4-1.7-7.3-2.1-11-1.2a15.99 15.99 0 00-11.7 19.3l86.2 352.2c1.3 5.3 5.2 9.6 10.4 11.3l147.7 50.7-147.6 50.7c-5.2 1.8-9.1 6-10.3 11.3L72.2 926.5c-.9 3.7-.5 7.6 1.2 10.9 3.9 7.9 13.5 11.1 21.5 7.2l836.5-417c3.1-1.5 5.6-4.1 7.2-7.1 3.9-8 .7-17.6-7.2-21.6zM170.8 826.3l50.3-205.6 295.2-101.3c2.3-.8 4.2-2.6 5-5 1.4-4.2-.8-8.7-5-10.2L221.1 403 171 198.2l628 314.9-628.2 313.2z"}}]},name:"send",theme:"outlined"},Oa=function(e,n){return i.createElement(de,ae({},e,{ref:n,icon:$a}))},Zn=i.forwardRef(Oa);const Ia=(t,e,n,o)=>{const{titleMarginBottom:r,fontWeightStrong:s}=o;return{marginBottom:r,color:n,fontWeight:s,fontSize:t,lineHeight:e}},Ta=t=>{const e=[1,2,3,4,5],n={};return e.forEach(o=>{n[`
      h${o}&,
      div&-h${o},
      div&-h${o} > textarea,
      h${o}
    `]=Ia(t[`fontSizeHeading${o}`],t[`lineHeightHeading${o}`],t.colorTextHeading,t)}),n},Ra=t=>{const{componentCls:e}=t;return{"a&, a":Object.assign(Object.assign({},po(t)),{userSelect:"text",[`&[disabled], &${e}-disabled`]:{color:t.colorTextDisabled,cursor:"not-allowed","&:active, &:hover":{color:t.colorTextDisabled},"&:active":{pointerEvents:"none"}}})}},_a=t=>({code:{margin:"0 0.2em",paddingInline:"0.4em",paddingBlock:"0.2em 0.1em",fontSize:"85%",fontFamily:t.fontFamilyCode,background:"rgba(150, 150, 150, 0.1)",border:"1px solid rgba(100, 100, 100, 0.2)",borderRadius:3},kbd:{margin:"0 0.2em",paddingInline:"0.4em",paddingBlock:"0.15em 0.1em",fontSize:"90%",fontFamily:t.fontFamilyCode,background:"rgba(150, 150, 150, 0.06)",border:"1px solid rgba(100, 100, 100, 0.2)",borderBottomWidth:2,borderRadius:3},mark:{padding:0,backgroundColor:Sr[2]},"u, ins":{textDecoration:"underline",textDecorationSkipInk:"auto"},"s, del":{textDecoration:"line-through"},strong:{fontWeight:t.fontWeightStrong},"ul, ol":{marginInline:0,marginBlock:"0 1em",padding:0,li:{marginInline:"20px 0",marginBlock:0,paddingInline:"4px 0",paddingBlock:0}},ul:{listStyleType:"circle",ul:{listStyleType:"disc"}},ol:{listStyleType:"decimal"},"pre, blockquote":{margin:"1em 0"},pre:{padding:"0.4em 0.6em",whiteSpace:"pre-wrap",wordWrap:"break-word",background:"rgba(150, 150, 150, 0.1)",border:"1px solid rgba(100, 100, 100, 0.2)",borderRadius:3,fontFamily:t.fontFamilyCode,code:{display:"inline",margin:0,padding:0,fontSize:"inherit",fontFamily:"inherit",background:"transparent",border:0}},blockquote:{paddingInline:"0.6em 0",paddingBlock:0,borderInlineStart:"4px solid rgba(100, 100, 100, 0.2)",opacity:.85}}),Na=t=>{const{componentCls:e,paddingSM:n}=t,o=n;return{"&-edit-content":{position:"relative","div&":{insetInlineStart:t.calc(t.paddingSM).mul(-1).equal(),marginTop:t.calc(o).mul(-1).equal(),marginBottom:`calc(1em - ${H(o)})`},[`${e}-edit-content-confirm`]:{position:"absolute",insetInlineEnd:t.calc(t.marginXS).add(2).equal(),insetBlockEnd:t.marginXS,color:t.colorIcon,fontWeight:"normal",fontSize:t.fontSize,fontStyle:"normal",pointerEvents:"none"},textarea:{margin:"0!important",MozTransition:"none",height:"1em"}}}},Ma=t=>({[`${t.componentCls}-copy-success`]:{"\n    &,\n    &:hover,\n    &:focus":{color:t.colorSuccess}},[`${t.componentCls}-copy-icon-only`]:{marginInlineStart:0}}),Pa=()=>({"\n  a&-ellipsis,\n  span&-ellipsis\n  ":{display:"inline-block",maxWidth:"100%"},"&-ellipsis-single-line":{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis","a&, span&":{verticalAlign:"bottom"},"> code":{paddingBlock:0,maxWidth:"calc(100% - 1.2em)",display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",verticalAlign:"bottom",boxSizing:"content-box"}},"&-ellipsis-multiple-line":{display:"-webkit-box",overflow:"hidden",WebkitLineClamp:3,WebkitBoxOrient:"vertical"}}),Ba=t=>{const{componentCls:e,titleMarginTop:n}=t;return{[e]:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:t.colorText,wordBreak:"break-word",lineHeight:t.lineHeight,[`&${e}-secondary`]:{color:t.colorTextDescription},[`&${e}-success`]:{color:t.colorSuccessText},[`&${e}-warning`]:{color:t.colorWarningText},[`&${e}-danger`]:{color:t.colorErrorText,"a&:active, a&:focus":{color:t.colorErrorTextActive},"a&:hover":{color:t.colorErrorTextHover}},[`&${e}-disabled`]:{color:t.colorTextDisabled,cursor:"not-allowed",userSelect:"none"},"\n        div&,\n        p\n      ":{marginBottom:"1em"}},Ta(t)),{[`
      & + h1${e},
      & + h2${e},
      & + h3${e},
      & + h4${e},
      & + h5${e}
      `]:{marginTop:n},"\n      div,\n      ul,\n      li,\n      p,\n      h1,\n      h2,\n      h3,\n      h4,\n      h5":{"\n        + h1,\n        + h2,\n        + h3,\n        + h4,\n        + h5\n        ":{marginTop:n}}}),_a(t)),Ra(t)),{[`
        ${e}-expand,
        ${e}-collapse,
        ${e}-edit,
        ${e}-copy
      `]:Object.assign(Object.assign({},po(t)),{marginInlineStart:t.marginXXS})}),Na(t)),Ma(t)),Pa()),{"&-rtl":{direction:"rtl"}})}},ka=()=>({titleMarginTop:"1.2em",titleMarginBottom:"0.5em"}),Fo=Je("Typography",Ba,ka),Aa=t=>{const{prefixCls:e,"aria-label":n,className:o,style:r,direction:s,maxLength:a,autoSize:c=!0,value:l,onSave:d,onCancel:f,onEnd:u,component:m,enterIcon:p=i.createElement(ha,null)}=t,h=i.useRef(null),g=i.useRef(!1),x=i.useRef(null),[v,$]=i.useState(l);i.useEffect(()=>{$(l)},[l]),i.useEffect(()=>{var E;if(!((E=h.current)===null||E===void 0)&&E.resizableTextArea){const{textArea:N}=h.current.resizableTextArea;N.focus();const{length:A}=N.value;N.setSelectionRange(A,A)}},[]);const I=({target:E})=>{$(E.value.replace(/[\n\r]/g,""))},S=()=>{g.current=!0},y=()=>{g.current=!1},_=({keyCode:E})=>{g.current||(x.current=E)},w=()=>{d(v.trim())},C=({keyCode:E,ctrlKey:N,altKey:A,metaKey:B,shiftKey:k})=>{x.current!==E||g.current||N||A||B||k||(E===ct.ENTER?(w(),u?.()):E===ct.ESC&&f())},O=()=>{w()},[T,R,P]=Fo(e),M=U(e,`${e}-edit-content`,{[`${e}-rtl`]:s==="rtl",[`${e}-${m}`]:!!m},o,R,P);return T(i.createElement("div",{className:M,style:r},i.createElement(pi,{ref:h,maxLength:a,value:v,onChange:I,onKeyDown:_,onKeyUp:C,onCompositionStart:S,onCompositionEnd:y,onBlur:O,"aria-label":n,rows:1,autoSize:c}),p!==null?ut(p,{className:`${e}-edit-content-confirm`}):null))};var qt,Qn;function ja(){return Qn||(Qn=1,qt=function(){var t=document.getSelection();if(!t.rangeCount)return function(){};for(var e=document.activeElement,n=[],o=0;o<t.rangeCount;o++)n.push(t.getRangeAt(o));switch(e.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":e.blur();break;default:e=null;break}return t.removeAllRanges(),function(){t.type==="Caret"&&t.removeAllRanges(),t.rangeCount||n.forEach(function(r){t.addRange(r)}),e&&e.focus()}}),qt}var Xt,Jn;function La(){if(Jn)return Xt;Jn=1;var t=ja(),e={"text/plain":"Text","text/html":"Url",default:"Text"},n="Copy to clipboard: #{key}, Enter";function o(s){var a=(/mac os x/i.test(navigator.userAgent)?"⌘":"Ctrl")+"+C";return s.replace(/#{\s*key\s*}/g,a)}function r(s,a){var c,l,d,f,u,m,p=!1;a||(a={}),c=a.debug||!1;try{d=t(),f=document.createRange(),u=document.getSelection(),m=document.createElement("span"),m.textContent=s,m.ariaHidden="true",m.style.all="unset",m.style.position="fixed",m.style.top=0,m.style.clip="rect(0, 0, 0, 0)",m.style.whiteSpace="pre",m.style.webkitUserSelect="text",m.style.MozUserSelect="text",m.style.msUserSelect="text",m.style.userSelect="text",m.addEventListener("copy",function(g){if(g.stopPropagation(),a.format)if(g.preventDefault(),typeof g.clipboardData>"u"){c&&console.warn("unable to use e.clipboardData"),c&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var x=e[a.format]||e.default;window.clipboardData.setData(x,s)}else g.clipboardData.clearData(),g.clipboardData.setData(a.format,s);a.onCopy&&(g.preventDefault(),a.onCopy(g.clipboardData))}),document.body.appendChild(m),f.selectNodeContents(m),u.addRange(f);var h=document.execCommand("copy");if(!h)throw new Error("copy command was unsuccessful");p=!0}catch(g){c&&console.error("unable to copy using execCommand: ",g),c&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(a.format||"text",s),a.onCopy&&a.onCopy(window.clipboardData),p=!0}catch(x){c&&console.error("unable to copy using clipboardData: ",x),c&&console.error("falling back to prompt"),l=o("message"in a?a.message:n),window.prompt(l,s)}}finally{u&&(typeof u.removeRange=="function"?u.removeRange(f):u.removeAllRanges()),m&&document.body.removeChild(m),d()}return p}return Xt=r,Xt}var za=La();const Da=Er(za);var Ha=function(t,e,n,o){function r(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function c(f){try{d(o.next(f))}catch(u){a(u)}}function l(f){try{d(o.throw(f))}catch(u){a(u)}}function d(f){f.done?s(f.value):r(f.value).then(c,l)}d((o=o.apply(t,e||[])).next())})};const Fa=({copyConfig:t,children:e})=>{const[n,o]=i.useState(!1),[r,s]=i.useState(!1),a=i.useRef(null),c=()=>{a.current&&clearTimeout(a.current)},l={};t.format&&(l.format=t.format),i.useEffect(()=>c,[]);const d=hn(f=>Ha(void 0,void 0,void 0,function*(){var u;f?.preventDefault(),f?.stopPropagation(),s(!0);try{const m=typeof t.text=="function"?yield t.text():t.text;Da(m||Gs(e,!0).join("")||"",l),s(!1),o(!0),c(),a.current=setTimeout(()=>{o(!1)},3e3),(u=t.onCopy)===null||u===void 0||u.call(t,f)}catch(m){throw s(!1),m}}));return{copied:n,copyLoading:r,onClick:d}};function Yt(t,e){return i.useMemo(()=>{const n=!!t;return[n,Object.assign(Object.assign({},e),n&&typeof t=="object"?t:null)]},[t])}const Va=t=>{const e=i.useRef(void 0);return i.useEffect(()=>{e.current=t}),e.current},Ua=(t,e,n)=>i.useMemo(()=>t===!0?{title:e??n}:i.isValidElement(t)?{title:t}:typeof t=="object"?Object.assign({title:e??n},t):{title:t},[t,e,n]);var Wa=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]]);return n};const Vo=i.forwardRef((t,e)=>{const{prefixCls:n,component:o="article",className:r,rootClassName:s,setContentRef:a,children:c,direction:l,style:d}=t,f=Wa(t,["prefixCls","component","className","rootClassName","setContentRef","children","direction","style"]),{getPrefixCls:u,direction:m,className:p,style:h}=_t("typography"),g=l??m,x=a?ho(e,a):e,v=u("typography",n),[$,I,S]=Fo(v),y=U(v,p,{[`${v}-rtl`]:g==="rtl"},r,s,I,S),_=Object.assign(Object.assign({},h),d);return $(i.createElement(o,Object.assign({className:y,style:_,ref:x},f),c))});function eo(t){return t===!1?[!1,!1]:Array.isArray(t)?t:[t]}function Gt(t,e,n){return t===!0||t===void 0?e:t||n&&e}function qa(t){const e=document.createElement("em");t.appendChild(e);const n=t.getBoundingClientRect(),o=e.getBoundingClientRect();return t.removeChild(e),n.left>o.left||o.right>n.right||n.top>o.top||o.bottom>n.bottom}const Cn=t=>["string","number"].includes(typeof t),Xa=({prefixCls:t,copied:e,locale:n,iconOnly:o,tooltips:r,icon:s,tabIndex:a,onCopy:c,loading:l})=>{const d=eo(r),f=eo(s),{copied:u,copy:m}=n??{},p=e?u:m,h=Gt(d[e?1:0],p),g=typeof h=="string"?h:p;return i.createElement(Mt,{title:h,getPopupContainer:x=>x.parentNode},i.createElement("button",{type:"button",className:U(`${t}-copy`,{[`${t}-copy-success`]:e,[`${t}-copy-icon-only`]:o}),onClick:c,"aria-label":g,tabIndex:a},e?Gt(f[1],i.createElement(go,null),!0):Gt(f[0],l?i.createElement(hi,null):i.createElement(aa,null),!0)))},gt=i.forwardRef(({style:t,children:e},n)=>{const o=i.useRef(null);return i.useImperativeHandle(n,()=>({isExceed:()=>{const r=o.current;return r.scrollHeight>r.clientHeight},getHeight:()=>o.current.clientHeight})),i.createElement("span",{"aria-hidden":!0,ref:o,style:Object.assign({position:"fixed",display:"block",left:0,top:0,pointerEvents:"none",backgroundColor:"rgba(255, 0, 0, 0.65)"},t)},e)}),Ya=t=>t.reduce((e,n)=>e+(Cn(n)?String(n).length:1),0);function to(t,e){let n=0;const o=[];for(let r=0;r<t.length;r+=1){if(n===e)return o;const s=t[r],c=Cn(s)?String(s).length:1,l=n+c;if(l>e){const d=e-n;return o.push(String(s).slice(0,d)),o}o.push(s),n=l}return t}const Kt=0,Zt=1,Qt=2,Jt=3,no=4,vt={display:"-webkit-box",overflow:"hidden",WebkitBoxOrient:"vertical"};function Ga(t){const{enableMeasure:e,width:n,text:o,children:r,rows:s,expanded:a,miscDeps:c,onEllipsis:l}=t,d=i.useMemo(()=>dt(o),[o]),f=i.useMemo(()=>Ya(d),[o]),u=i.useMemo(()=>r(d,!1),[o]),[m,p]=i.useState(null),h=i.useRef(null),g=i.useRef(null),x=i.useRef(null),v=i.useRef(null),$=i.useRef(null),[I,S]=i.useState(!1),[y,_]=i.useState(Kt),[w,C]=i.useState(0),[O,T]=i.useState(null);qe(()=>{_(e&&n&&f?Zt:Kt)},[n,o,s,e,d]),qe(()=>{var E,N,A,B;if(y===Zt){_(Qt);const k=g.current&&getComputedStyle(g.current).whiteSpace;T(k)}else if(y===Qt){const k=!!(!((E=x.current)===null||E===void 0)&&E.isExceed());_(k?Jt:no),p(k?[0,f]:null),S(k);const D=((N=x.current)===null||N===void 0?void 0:N.getHeight())||0,q=s===1?0:((A=v.current)===null||A===void 0?void 0:A.getHeight())||0,G=((B=$.current)===null||B===void 0?void 0:B.getHeight())||0,K=Math.max(D,q+G);C(K+1),l(k)}},[y]);const R=m?Math.ceil((m[0]+m[1])/2):0;qe(()=>{var E;const[N,A]=m||[0,0];if(N!==A){const k=(((E=h.current)===null||E===void 0?void 0:E.getHeight())||0)>w;let D=R;A-N===1&&(D=k?N:A),p(k?[N,D]:[D,A])}},[m,R]);const P=i.useMemo(()=>{if(!e)return r(d,!1);if(y!==Jt||!m||m[0]!==m[1]){const E=r(d,!1);return[no,Kt].includes(y)?E:i.createElement("span",{style:Object.assign(Object.assign({},vt),{WebkitLineClamp:s})},E)}return r(a?d:to(d,m[0]),I)},[a,y,m,d].concat(Nt(c))),M={width:n,margin:0,padding:0,whiteSpace:O==="nowrap"?"normal":"inherit"};return i.createElement(i.Fragment,null,P,y===Qt&&i.createElement(i.Fragment,null,i.createElement(gt,{style:Object.assign(Object.assign(Object.assign({},M),vt),{WebkitLineClamp:s}),ref:x},u),i.createElement(gt,{style:Object.assign(Object.assign(Object.assign({},M),vt),{WebkitLineClamp:s-1}),ref:v},u),i.createElement(gt,{style:Object.assign(Object.assign(Object.assign({},M),vt),{WebkitLineClamp:1}),ref:$},r([],!0))),y===Jt&&m&&m[0]!==m[1]&&i.createElement(gt,{style:Object.assign(Object.assign({},M),{top:400}),ref:h},r(to(d,R),!0)),y===Zt&&i.createElement("span",{style:{whiteSpace:"inherit"},ref:g}))}const Ka=({enableEllipsis:t,isEllipsis:e,children:n,tooltipProps:o})=>!o?.title||!t?n:i.createElement(Mt,Object.assign({open:e?void 0:!1},o),n);var Za=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]]);return n};function Qa({mark:t,code:e,underline:n,delete:o,strong:r,keyboard:s,italic:a},c){let l=c;function d(f,u){u&&(l=i.createElement(f,{},l))}return d("strong",r),d("u",n),d("del",o),d("code",e),d("mark",t),d("kbd",s),d("i",a),l}const Ja="...",oo=["delete","mark","code","underline","strong","keyboard","italic"],zt=i.forwardRef((t,e)=>{var n;const{prefixCls:o,className:r,style:s,type:a,disabled:c,children:l,ellipsis:d,editable:f,copyable:u,component:m,title:p}=t,h=Za(t,["prefixCls","className","style","type","disabled","children","ellipsis","editable","copyable","component","title"]),{getPrefixCls:g,direction:x}=i.useContext(Ae),[v]=yo("Text"),$=i.useRef(null),I=i.useRef(null),S=g("typography",o),y=De(h,oo),[_,w]=Yt(f),[C,O]=Ke(!1,{value:w.editing}),{triggerType:T=["icon"]}=w,R=j=>{var V;j&&((V=w.onStart)===null||V===void 0||V.call(w)),O(j)},P=Va(C);qe(()=>{var j;!C&&P&&((j=I.current)===null||j===void 0||j.focus())},[C]);const M=j=>{j?.preventDefault(),R(!0)},E=j=>{var V;(V=w.onChange)===null||V===void 0||V.call(w,j),R(!1)},N=()=>{var j;(j=w.onCancel)===null||j===void 0||j.call(w),R(!1)},[A,B]=Yt(u),{copied:k,copyLoading:D,onClick:q}=Fa({copyConfig:B,children:l}),[G,K]=i.useState(!1),[L,J]=i.useState(!1),[Z,X]=i.useState(!1),[oe,F]=i.useState(!1),[re,te]=i.useState(!0),[ne,Y]=Yt(d,{expandable:!1,symbol:j=>j?v?.collapse:v?.expand}),[ie,he]=Ke(Y.defaultExpanded||!1,{value:Y.expanded}),se=ne&&(!ie||Y.expandable==="collapsible"),{rows:ee=1}=Y,z=i.useMemo(()=>se&&(Y.suffix!==void 0||Y.onEllipsis||Y.expandable||_||A),[se,Y,_,A]);qe(()=>{ne&&!z&&(K(jn("webkitLineClamp")),J(jn("textOverflow")))},[z,ne]);const[Q,fe]=i.useState(se),ce=i.useMemo(()=>z?!1:ee===1?L:G,[z,L,G]);qe(()=>{fe(ce&&se)},[ce,se]);const Ee=se&&(Q?oe:Z),Me=se&&ee===1&&Q,ve=se&&ee>1&&Q,$e=(j,V)=>{var ye;he(V.expanded),(ye=Y.onExpand)===null||ye===void 0||ye.call(Y,j,V)},[He,nt]=i.useState(0),ot=({offsetWidth:j})=>{nt(j)},Ie=j=>{var V;X(j),Z!==j&&((V=Y.onEllipsis)===null||V===void 0||V.call(Y,j))};i.useEffect(()=>{const j=$.current;if(ne&&Q&&j){const V=qa(j);oe!==V&&F(V)}},[ne,Q,l,ve,re,He]),i.useEffect(()=>{const j=$.current;if(typeof IntersectionObserver>"u"||!j||!Q||!se)return;const V=new IntersectionObserver(()=>{te(!!j.offsetParent)});return V.observe(j),()=>{V.disconnect()}},[Q,se]);const be=Ua(Y.tooltip,w.text,l),Pe=i.useMemo(()=>{if(!(!ne||Q))return[w.text,l,p,be.title].find(Cn)},[ne,Q,p,be.title,Ee]);if(C)return i.createElement(Aa,{value:(n=w.text)!==null&&n!==void 0?n:typeof l=="string"?l:"",onSave:E,onCancel:N,onEnd:w.onEnd,prefixCls:S,className:r,style:s,direction:x,component:m,maxLength:w.maxLength,autoSize:w.autoSize,enterIcon:w.enterIcon});const Fe=()=>{const{expandable:j,symbol:V}=Y;return j?i.createElement("button",{type:"button",key:"expand",className:`${S}-${ie?"collapse":"expand"}`,onClick:ye=>$e(ye,{expanded:!ie}),"aria-label":ie?v.collapse:v?.expand},typeof V=="function"?V(ie):V):null},Ve=()=>{if(!_)return;const{icon:j,tooltip:V,tabIndex:ye}=w,ge=dt(V)[0]||v?.edit,Te=typeof ge=="string"?ge:"";return T.includes("icon")?i.createElement(Mt,{key:"edit",title:V===!1?"":ge},i.createElement("button",{type:"button",ref:I,className:`${S}-edit`,onClick:M,"aria-label":Te,tabIndex:ye},j||i.createElement(fa,{role:"button"}))):null},Vt=()=>A?i.createElement(Xa,Object.assign({key:"copy"},B,{prefixCls:S,copied:k,locale:v,onCopy:q,loading:D,iconOnly:l==null})):null,rt=j=>[j&&Fe(),Ve(),Vt()],Ut=j=>[j&&!ie&&i.createElement("span",{"aria-hidden":!0,key:"ellipsis"},Ja),Y.suffix,rt(j)];return i.createElement(gi,{onResize:ot,disabled:!se},j=>i.createElement(Ka,{tooltipProps:be,enableEllipsis:se,isEllipsis:Ee},i.createElement(Vo,Object.assign({className:U({[`${S}-${a}`]:a,[`${S}-disabled`]:c,[`${S}-ellipsis`]:ne,[`${S}-ellipsis-single-line`]:Me,[`${S}-ellipsis-multiple-line`]:ve},r),prefixCls:o,style:Object.assign(Object.assign({},s),{WebkitLineClamp:ve?ee:void 0}),component:m,ref:ho(j,$,e),direction:x,onClick:T.includes("text")?M:void 0,"aria-label":Pe?.toString(),title:p},y),i.createElement(Ga,{enableMeasure:se&&!Q,text:l,rows:ee,width:He,onEllipsis:Ie,expanded:ie,miscDeps:[k,ie,D,_,A,v].concat(Nt(oo.map(V=>t[V])))},(V,ye)=>Qa(t,i.createElement(i.Fragment,null,V.length>0&&ye&&!ie&&Pe?i.createElement("span",{key:"show-content","aria-hidden":!0},V):V,Ut(ye)))))))});var el=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]]);return n};const tl=i.forwardRef((t,e)=>{var{ellipsis:n,rel:o}=t,r=el(t,["ellipsis","rel"]);const s=Object.assign(Object.assign({},r),{rel:o===void 0&&r.target==="_blank"?"noopener noreferrer":o});return delete s.navigate,i.createElement(zt,Object.assign({},s,{ref:e,ellipsis:!!n,component:"a"}))}),nl=i.forwardRef((t,e)=>i.createElement(zt,Object.assign({ref:e},t,{component:"div"})));var ol=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]]);return n};const rl=(t,e)=>{var{ellipsis:n}=t,o=ol(t,["ellipsis"]);const r=i.useMemo(()=>n&&typeof n=="object"?De(n,["expandable","rows"]):n,[n]);return i.createElement(zt,Object.assign({ref:e},o,{ellipsis:r,component:"span"}))},il=i.forwardRef(rl);var sl=function(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]]);return n};const al=[1,2,3,4,5],ll=i.forwardRef((t,e)=>{const{level:n=1}=t,o=sl(t,["level"]),r=al.includes(n)?`h${n}`:"h1";return i.createElement(zt,Object.assign({ref:e},o,{component:r}))}),et=Vo;et.Text=il;et.Link=tl;et.Title=ll;et.Paragraph=nl;var cl=class extends $r{constructor(t,e){super(t,e)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(t){super.setOptions({...t,behavior:Mn()})}getOptimisticResult(t){return t.behavior=Mn(),super.getOptimisticResult(t)}fetchNextPage(t){return this.fetch({...t,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(t){return this.fetch({...t,meta:{fetchMore:{direction:"backward"}}})}createResult(t,e){const{state:n}=t,o=super.createResult(t,e),{isFetching:r,isRefetching:s,isError:a,isRefetchError:c}=o,l=n.fetchMeta?.fetchMore?.direction,d=a&&l==="forward",f=r&&l==="forward",u=a&&l==="backward",m=r&&l==="backward";return{...o,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:Ir(e,n.data),hasPreviousPage:Or(e,n.data),isFetchNextPageError:d,isFetchingNextPage:f,isFetchPreviousPageError:u,isFetchingPreviousPage:m,isRefetchError:c&&!d&&!u,isRefetching:s&&!f&&!m}}};function ul(t,e){return Tr(t,cl)}const dl=({id:t})=>{const{error:e,data:n,isLoading:o}=Rr({queryKey:["chats-details",t],queryFn:async()=>await Dr.getChatById(t)});return{error:e?e.message:null,data:n,loading:o}},fl=({placeholder:t,className:e,route:n})=>{const o=_r(),r=()=>{o(n||-1)};return b.jsx(xe,{type:"primary",onClick:r,className:e,style:{cursor:"pointer"},children:t||"Geri Qayıt"})},ml=i.memo(fl),{Header:pl}=ke,{Text:hl}=et,gl=({chatId:t})=>{const{loading:e,error:n,data:o}=dl({id:t});return e?b.jsx("div",{children:"loading..."}):n||!o?b.jsx("div",{children:"error..."}):b.jsxs(pl,{className:"flex items-center justify-between p-4 bg-gray-800 border-b border-gray-700",children:[b.jsx(ml,{placeholder:b.jsx(ta,{}),route:"/"}),b.jsx(hl,{className:"text-xl",children:o.name})]})},vl=i.memo(gl);var Qe=(t=>(t.TEXT="text",t.MEDIA="media",t.VOICE="voice",t))(Qe||{});const Uo=i.createContext(null),yl=i.memo(({children:t,value:e})=>b.jsx(Uo.Provider,{value:e,children:t})),Wo=()=>{const t=i.useContext(Uo);if(!t)throw new Error("useGetChatMessagesContract must be used within a GetChatMessagesContractProvider");return t},qo=i.createContext(null),bl=i.memo(({children:t,...e})=>b.jsx(qo.Provider,{value:e,children:t})),Xo=()=>{const t=i.useContext(qo);if(!t)throw new Error("useMeContract must be used within a MeContractProvider");return t};var Ce=(t=>(t.IMAGE="image",t.VIDEO="video",t.DOCUMENT="document",t.AUDIO="audio",t.VOICE="voice",t))(Ce||{});const xl=({media:t})=>{const e=o=>{try{const s=new URL(o).pathname.split("/");return decodeURIComponent(s[s.length-1])}catch(r){return console.log("Error parsing URL:",r),"file"}},n=`https://api.silent-talk.online${t.url}`;switch(t.type){case Ce.IMAGE:return b.jsx(Do,{src:n,alt:"image content",className:"max-w-full max-h-80 rounded-lg object-cover"});case Ce.VIDEO:return b.jsx("video",{src:n,controls:!0,className:"max-w-full max-h-80 rounded-lg"});case Ce.AUDIO:return b.jsx("audio",{src:n,controls:!0,className:"w-full"});case Ce.DOCUMENT:return b.jsxs("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"flex items-center p-2 bg-gray-600 hover:bg-gray-500 rounded-lg",children:[b.jsx(ts,{className:"mr-2 text-2xl"}),b.jsx("span",{className:"truncate",children:e(t.url)})]});default:return null}},wl=i.memo(xl),an=t=>{const e=Math.floor(t/60),n=t%60,o=String(e).padStart(2,"0"),r=String(n).padStart(2,"0");return`${o}:${r}`},Cl=({url:t})=>{const e=i.useRef(null),[n,o]=i.useState(!1),[r,s]=i.useState(0),[a,c]=i.useState(0),l=`${t}`,d=()=>{const u=e.current;u&&(n?u.pause():u.play(),o(!n))};i.useEffect(()=>{const u=e.current;if(!u)return;const m=()=>{u&&isFinite(u.duration)&&s(u.duration)},p=()=>c(u.currentTime),h=()=>o(!1);return u.addEventListener("loadedmetadata",m),u.addEventListener("durationchange",m),u.addEventListener("timeupdate",p),u.addEventListener("ended",h),u.readyState>0&&m(),()=>{u.removeEventListener("loadedmetadata",m),u.removeEventListener("durationchange",m),u.removeEventListener("timeupdate",p),u.removeEventListener("ended",h)}},[l]);const f=r>0?a/r*100:0;return b.jsxs("div",{className:"flex items-center w-full max-w-xs gap-2",children:[b.jsx("audio",{ref:e,src:l,preload:"metadata"}),b.jsx(xe,{type:"text",shape:"circle",onClick:d,icon:n?b.jsx(wa,{}):b.jsx(Ea,{}),className:"text-2xl"}),b.jsx("div",{className:"flex-grow bg-gray-500 bg-opacity-50 h-1 rounded-full",children:b.jsx("div",{style:{width:`${f}%`},className:"bg-blue-400 h-1 rounded-full"})}),b.jsxs("span",{className:"text-xs font-mono w-20 text-right whitespace-nowrap",children:[an(Math.floor(a))," / ",an(Math.floor(r))]})]})},Sl=i.memo(Cl);class El{constructor(e={}){this.handlers=new Map,this.wildcardHandlers=new Set,this.config={onError:n=>console.error(`EventBus error: ${n.message}`),maxListeners:20,...e}}on(e,n){this.validateHandler(n),this.handlers.has(e)||this.handlers.set(e,new Set);const o=this.handlers.get(e);return this.config.maxListeners&&o.size>=this.config.maxListeners&&console.warn(`Event "${String(e)}" has exceeded the maximum listeners (${this.config.maxListeners})`),o.add(n),()=>this.off(e,n)}once(e,n){const o=r=>{try{n(r)}finally{this.off(e,o)}};return this.on(e,o)}off(e,n){if(!this.handlers.has(e))return;const o=this.handlers.get(e);o.delete(n),o.size===0&&this.handlers.delete(e)}offAll(e){e?this.handlers.delete(e):(this.handlers.clear(),this.wildcardHandlers.clear())}emit(e,n){this.handlers.has(e)&&new Set(this.handlers.get(e)).forEach(r=>{try{r(n)}catch(s){this.config.onError?.(s,e,n)}}),this.wildcardHandlers.forEach(o=>{try{o(e,n)}catch(r){this.config.onError?.(r,e,n)}})}onAll(e){return this.wildcardHandlers.add(e),()=>{this.wildcardHandlers.delete(e)}}all(){return new Map(this.handlers)}validateHandler(e){if(typeof e!="function")throw new Error("Event handler must be a function")}}const Sn=t=>new El(t),ro=Sn(),Yo=i.createContext(null),$l=({children:t,eventBus:e,config:n})=>{const o=i.useMemo(()=>e||(n?Sn(n):ro),[e,n,ro]),r=i.useMemo(()=>({eventBus:o}),[o]);return b.jsx(Yo.Provider,{value:r,children:t})},Ol=i.memo($l),Il=()=>{const t=i.useContext(Yo);if(!t)throw new Error("useEventBusContext must be used within an EventBusProvider");return t},Go=t=>{try{const e=Il();return t?.eventBus||e.eventBus}catch{return t?.eventBus||Sn()}},Ko=(t,e,n=[],o)=>{const r=Go(o),s=i.useRef(e);i.useEffect(()=>{s.current=e},[e,...n]),i.useEffect(()=>{const a=l=>s.current(l);return r.on(t,a)},[t,r])},Tl=t=>{const e=Go(t);return i.useCallback((n,o)=>{e.emit(n,o)},[e])},Rl=({event:t,handler:e,eventBus:n})=>(Ko(t,e,[],{eventBus:n}),null);i.memo(Rl);const{Text:ln}=et,_l=({message:t})=>{const e=Tl();return b.jsxs("button",{onClick:()=>e(`scrollToMessage-${t.id}`,t.id),className:"mb-2 flex flex-col items-start p-2 border-l-4 border-blue-400 bg-black bg-opacity-20 rounded w-full",children:[b.jsx(ln,{className:"font-bold text-sm text-gray-300",children:t?.user?.username||"Not defined"}),b.jsx("p",{className:"text-sm text-gray-400 truncate",children:t.text?.substring(0,25)||"Медиафайл"})]})},Nl=i.memo(({item:t})=>{const{me:e}=Xo(),{setEditMessage:n,setReplyToMessage:o,handleDeleteMessage:r,mutationLoading:s}=Wo(),c=i.useCallback(d=>e?.id===d,[e?.id])(t.user.id),l=[{key:"reply",disabled:s,label:"Ответить",onClick:()=>o(t)},{key:"delete",label:"Удалить",danger:!0,disabled:s,onClick:()=>r(t.id)},...c?[{key:"edit",disabled:s,label:"Редактировать",onClick:()=>n(t)}]:[]];return Ko(`scrollToMessage-${t.id}`,d=>{const f=document.getElementById(d);f&&(f.scrollIntoView({behavior:"smooth",block:"center"}),f.classList.add("bg-yellow-300"),setTimeout(()=>{f.classList.remove("bg-yellow-300")},2e3))}),b.jsx(vo.Item,{id:t.id,className:`flex ${c?"justify-end":"justify-start"} transition-all duration-300 !p-2 rounded-lg`,style:{border:"none",paddingBottom:"1rem"},children:b.jsxs("div",{className:"flex items-start max-w-xl w-full",children:[!c&&b.jsx("div",{className:"mr-3 flex-shrink-0",children:b.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-500 flex items-center justify-center text-white font-bold",children:t.user.username.charAt(0).toUpperCase()})}),b.jsxs("div",{className:`relative p-3 rounded-lg w-full ${c?"bg-blue-600 text-white":"bg-gray-700 text-gray-200"}`,children:[b.jsx("div",{className:"absolute top-1 right-1 z-10",children:b.jsx(Po,{menu:{items:l},trigger:["click"],children:b.jsx(xe,{type:"text",shape:"circle",icon:b.jsx(vn,{className:"text-gray-400"})})})}),t.replyTo&&b.jsx(_l,{message:t.replyTo}),b.jsx(ln,{className:`font-bold ${c?"text-white":"text-gray-300"}`,children:c?"Вы":t.user.username}),t.type===Qe.VOICE&&t.medias&&t?.medias?.length>0?b.jsx("div",{className:"mt-2",children:b.jsx(Sl,{url:`https://api.silent-talk.online${t.medias[0].url}`})}):b.jsxs(b.Fragment,{children:[t.medias&&t.medias.length>0&&b.jsx("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 gap-2",children:t.medias.map(d=>b.jsx(wl,{media:d},d.id))}),t.text&&b.jsx("p",{className:"pr-8 whitespace-pre-wrap mt-1",children:t.text})]}),b.jsx(ln,{className:"text-xs text-gray-400 mt-2 block text-right",children:new Date(t.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),c&&b.jsx("div",{className:"ml-3 flex-shrink-0",children:b.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold",children:"Я"})})]})})}),Ml=()=>{const{loading:t,hasMore:e,messages:n,chatRef:o,fetchMoreMessages:r,isFetchingMore:s}=Wo(),{loading:a}=Xo();console.log("Messages",n);const[c,l]=i.useState(!1),d=i.useCallback(()=>{o.current&&o.current.scrollTo({top:o.current.scrollHeight,behavior:"smooth"})},[o]),f=i.useRef(null);return i.useLayoutEffect(()=>{!t&&o?.current&&(o.current.scrollTop=o.current.scrollHeight)},[t,n,o]),i.useLayoutEffect(()=>{f.current&&o.current&&(o.current.scrollTop=o.current.scrollHeight-f.current,f.current=null)},[o,n]),i.useEffect(()=>{const u=o.current,m=()=>{if(!u)return;u.scrollTop===0&&!s&&e&&(f.current=u.scrollHeight,r()),u.scrollHeight-u.scrollTop-u.clientHeight>300?l(!0):l(!1)};return u?.addEventListener("scroll",m),()=>{u?.removeEventListener("scroll",m)}},[o,r,s,e]),a||t?b.jsx("div",{className:"flex-grow p-4 flex items-center justify-center",children:"Loading..."}):b.jsxs("div",{ref:o,className:"flex-grow p-4 overflow-y-auto relative",children:[s&&b.jsx("div",{className:"flex justify-center my-2",children:b.jsx("p",{className:"text-gray-400",children:"Загрузка предыдущих сообщений..."})}),b.jsx(Ol,{children:b.jsx(vo,{itemLayout:"horizontal",dataSource:n,renderItem:u=>b.jsx(Nl,{item:u},u.id)})}),c&&b.jsx(xe,{type:"primary",shape:"circle",size:"large",icon:b.jsx(Qs,{}),className:"fixed right-[26px] bottom-[90px] z-20 animate-fade-in",onClick:d})]})},Pl=i.memo(Ml),Zo=i.createContext(null),Bl=i.memo(({children:t,value:e})=>b.jsx(Zo.Provider,{value:e,children:t})),kl=()=>{const t=i.useContext(Zo);if(!t)throw new Error("useChatContract must be used within a ChatContractProvider");return t},Al=t=>{const e=t.type;return e.startsWith("image/")?"photo":e.startsWith("video/")?"video":e.startsWith("audio/")?"audio":"document"},jl=t=>t==="photo"?Ce.IMAGE:t==="video"?Ce.VIDEO:t==="audio"?Ce.AUDIO:Ce.DOCUMENT,Ll=()=>{const t=kl(),e=i.useRef(null),n=()=>{e.current?.click()},o=async s=>{if(t.mode!=="default")return;const a=s.target.files;if(!a||a.length===0)return;const l=Array.from(a).reduce((f,u)=>{const m=Al(u);return f[m]||(f[m]=[]),f[m].push(u),f},{}),d=[];for(const f in l){const u=f,m=l[u],p=await t.handleMultipleUpload(u,m);if(p){const h=p.split(","),g=jl(u);h.forEach(x=>{d.push({url:x,type:g})})}}if(d.length>0){const f=t.chatForm.getValues("medias")||[];t.chatForm.setValue("medias",[...f,...d])}e.current&&(e.current.value="")},r=s=>{switch(s.mode){case"voice":return b.jsxs("div",{className:"flex items-center justify-between w-full",children:[b.jsx(xe,{type:"primary",danger:!0,size:"large",htmlType:"button",shape:"circle",icon:b.jsx(Kn,{}),onClick:s.cancelRecording}),b.jsx("div",{className:"text-gray-300 font-mono mx-4",children:an(s.recordingTimer)}),b.jsx(xe,{type:"primary",size:"large",shape:"circle",icon:b.jsx(Zn,{}),onClick:s.stopRecording,loading:s.mutationLoading})]});case"edit":return b.jsxs(b.Fragment,{children:[b.jsx(kn,{name:"text",control:s.chatForm.control,render:({field:a})=>b.jsx(An,{...a,size:"large",placeholder:"Редактировать сообщение...",className:"flex-grow mr-4",disabled:s.mutationLoading,autoFocus:!0})}),b.jsx(xe,{type:"primary",size:"large",icon:b.jsx(go,{}),htmlType:"submit",loading:s.mutationLoading})]});case"default":{const{chatForm:a}=s,c=a.watch("text"),l=a.watch("medias"),d=c&&c.trim().length>0,f=l&&l.length>0,u=d||f,m=u?b.jsx(Zn,{}):b.jsx(ra,{});return b.jsxs("div",{className:"flex flex-col w-full",children:[l&&l.length>0&&b.jsx("div",{className:"flex space-x-2 mb-2 overflow-x-auto",children:l.map((p,h)=>b.jsxs("div",{className:"relative",children:[p.type===Ce.IMAGE?b.jsx("img",{src:`https://api.silent-talk.online${p.url}`,alt:`attachment-${h}`,className:"h-16 w-16 object-cover rounded"}):b.jsx("div",{className:"h-16 w-16 flex items-center justify-center bg-gray-700 rounded",children:b.jsx("span",{className:"text-sm text-gray-300",children:p.type.charAt(0).toUpperCase()+p.type.slice(1)})}),b.jsx(xe,{type:"text",shape:"circle",icon:b.jsx(Kn,{}),size:"small",className:"absolute -top-2 -right-2 bg-red-600 text-white",onClick:()=>{const g=l.filter((x,v)=>v!==h);a.setValue("medias",g)}})]},h))}),b.jsxs("div",{className:"flex items-center w-full justify-between",children:[b.jsx("input",{type:"file",multiple:!0,ref:e,onChange:o,style:{display:"none"}}),b.jsx(xe,{size:"large",icon:b.jsx(ya,{}),onClick:n,className:"mr-4",disabled:s.mutationLoading}),b.jsx(kn,{name:"text",control:a.control,render:({field:p})=>b.jsx(An,{...p,size:"large",placeholder:"Напишите сообщение...",className:"flex-grow mr-4",disabled:s.mutationLoading})}),b.jsx(xe,{type:"primary",size:"large",icon:m,loading:s.mutationLoading,htmlType:u?"submit":"button",onClick:u?void 0:s.startRecording})]})]})}default:return null}};return b.jsxs("div",{className:"p-4 bg-gray-800 border-t border-gray-700",children:[t.replyToMessage&&b.jsx(Bn,{message:`Ответ на сообщение: ${t.replyToMessage.type===Qe.TEXT?`${t.replyToMessage.text?.substring(0,50)||"Медиафайл"}...`:"Голосове сообщение"}`,type:"info",closable:!0,onClose:()=>t.setReplyToMessage(null),className:"mb-2"}),t.mode==="edit"&&t.editMessage&&b.jsx(Bn,{message:"Редактирование сообщения...",type:"warning",closable:!0,onClose:t.cancelEdit,className:"mb-2"}),b.jsx("form",{onSubmit:t.mode!=="voice"?s=>{s.preventDefault(),t.chatForm.setValue("type",Qe.TEXT),t.handleSubmit(s)}:s=>s.preventDefault(),className:"flex items-center",children:r(t)})]})},zl=i.memo(Ll),Ne=Object.create(null);Ne.open="0";Ne.close="1";Ne.ping="2";Ne.pong="3";Ne.message="4";Ne.upgrade="5";Ne.noop="6";const xt=Object.create(null);Object.keys(Ne).forEach(t=>{xt[Ne[t]]=t});const cn={type:"error",data:"parser error"},Qo=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",Jo=typeof ArrayBuffer=="function",er=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,En=({type:t,data:e},n,o)=>Qo&&e instanceof Blob?n?o(e):io(e,o):Jo&&(e instanceof ArrayBuffer||er(e))?n?o(e):io(new Blob([e]),o):o(Ne[t]+(e||"")),io=(t,e)=>{const n=new FileReader;return n.onload=function(){const o=n.result.split(",")[1];e("b"+(o||""))},n.readAsDataURL(t)};function so(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}let en;function Dl(t,e){if(Qo&&t.data instanceof Blob)return t.data.arrayBuffer().then(so).then(e);if(Jo&&(t.data instanceof ArrayBuffer||er(t.data)))return e(so(t.data));En(t,!1,n=>{en||(en=new TextEncoder),e(en.encode(n))})}const ao="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",at=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<ao.length;t++)at[ao.charCodeAt(t)]=t;const Hl=t=>{let e=t.length*.75,n=t.length,o,r=0,s,a,c,l;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);const d=new ArrayBuffer(e),f=new Uint8Array(d);for(o=0;o<n;o+=4)s=at[t.charCodeAt(o)],a=at[t.charCodeAt(o+1)],c=at[t.charCodeAt(o+2)],l=at[t.charCodeAt(o+3)],f[r++]=s<<2|a>>4,f[r++]=(a&15)<<4|c>>2,f[r++]=(c&3)<<6|l&63;return d},Fl=typeof ArrayBuffer=="function",$n=(t,e)=>{if(typeof t!="string")return{type:"message",data:tr(t,e)};const n=t.charAt(0);return n==="b"?{type:"message",data:Vl(t.substring(1),e)}:xt[n]?t.length>1?{type:xt[n],data:t.substring(1)}:{type:xt[n]}:cn},Vl=(t,e)=>{if(Fl){const n=Hl(t);return tr(n,e)}else return{base64:!0,data:t}},tr=(t,e)=>{switch(e){case"blob":return t instanceof Blob?t:new Blob([t]);case"arraybuffer":default:return t instanceof ArrayBuffer?t:t.buffer}},nr="",Ul=(t,e)=>{const n=t.length,o=new Array(n);let r=0;t.forEach((s,a)=>{En(s,!1,c=>{o[a]=c,++r===n&&e(o.join(nr))})})},Wl=(t,e)=>{const n=t.split(nr),o=[];for(let r=0;r<n.length;r++){const s=$n(n[r],e);if(o.push(s),s.type==="error")break}return o};function ql(){return new TransformStream({transform(t,e){Dl(t,n=>{const o=n.length;let r;if(o<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,o);else if(o<65536){r=new Uint8Array(3);const s=new DataView(r.buffer);s.setUint8(0,126),s.setUint16(1,o)}else{r=new Uint8Array(9);const s=new DataView(r.buffer);s.setUint8(0,127),s.setBigUint64(1,BigInt(o))}t.data&&typeof t.data!="string"&&(r[0]|=128),e.enqueue(r),e.enqueue(n)})}})}let tn;function yt(t){return t.reduce((e,n)=>e+n.length,0)}function bt(t,e){if(t[0].length===e)return t.shift();const n=new Uint8Array(e);let o=0;for(let r=0;r<e;r++)n[r]=t[0][o++],o===t[0].length&&(t.shift(),o=0);return t.length&&o<t[0].length&&(t[0]=t[0].slice(o)),n}function Xl(t,e){tn||(tn=new TextDecoder);const n=[];let o=0,r=-1,s=!1;return new TransformStream({transform(a,c){for(n.push(a);;){if(o===0){if(yt(n)<1)break;const l=bt(n,1);s=(l[0]&128)===128,r=l[0]&127,r<126?o=3:r===126?o=1:o=2}else if(o===1){if(yt(n)<2)break;const l=bt(n,2);r=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),o=3}else if(o===2){if(yt(n)<8)break;const l=bt(n,8),d=new DataView(l.buffer,l.byteOffset,l.length),f=d.getUint32(0);if(f>Math.pow(2,21)-1){c.enqueue(cn);break}r=f*Math.pow(2,32)+d.getUint32(4),o=3}else{if(yt(n)<r)break;const l=bt(n,r);c.enqueue($n(s?l:tn.decode(l),e)),o=0}if(r===0||r>t){c.enqueue(cn);break}}}})}const or=4;function ue(t){if(t)return Yl(t)}function Yl(t){for(var e in ue.prototype)t[e]=ue.prototype[e];return t}ue.prototype.on=ue.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this};ue.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this};ue.prototype.off=ue.prototype.removeListener=ue.prototype.removeAllListeners=ue.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var n=this._callbacks["$"+t];if(!n)return this;if(arguments.length==1)return delete this._callbacks["$"+t],this;for(var o,r=0;r<n.length;r++)if(o=n[r],o===e||o.fn===e){n.splice(r,1);break}return n.length===0&&delete this._callbacks["$"+t],this};ue.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],o=1;o<arguments.length;o++)e[o-1]=arguments[o];if(n){n=n.slice(0);for(var o=0,r=n.length;o<r;++o)n[o].apply(this,e)}return this};ue.prototype.emitReserved=ue.prototype.emit;ue.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]};ue.prototype.hasListeners=function(t){return!!this.listeners(t).length};const Dt=typeof Promise=="function"&&typeof Promise.resolve=="function"?e=>Promise.resolve().then(e):(e,n)=>n(e,0),we=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Gl="arraybuffer";function rr(t,...e){return e.reduce((n,o)=>(t.hasOwnProperty(o)&&(n[o]=t[o]),n),{})}const Kl=we.setTimeout,Zl=we.clearTimeout;function Ht(t,e){e.useNativeTimers?(t.setTimeoutFn=Kl.bind(we),t.clearTimeoutFn=Zl.bind(we)):(t.setTimeoutFn=we.setTimeout.bind(we),t.clearTimeoutFn=we.clearTimeout.bind(we))}const Ql=1.33;function Jl(t){return typeof t=="string"?ec(t):Math.ceil((t.byteLength||t.size)*Ql)}function ec(t){let e=0,n=0;for(let o=0,r=t.length;o<r;o++)e=t.charCodeAt(o),e<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(o++,n+=4);return n}function ir(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function tc(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e}function nc(t){let e={},n=t.split("&");for(let o=0,r=n.length;o<r;o++){let s=n[o].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}class oc extends Error{constructor(e,n,o){super(e),this.description=n,this.context=o,this.type="TransportError"}}class On extends ue{constructor(e){super(),this.writable=!1,Ht(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,n,o){return super.emitReserved("error",new oc(e,n,o)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(e){this.readyState==="open"&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const n=$n(e,this.socket.binaryType);this.onPacket(n)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e,n={}){return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){const e=this.opts.hostname;return e.indexOf(":")===-1?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(e){const n=tc(e);return n.length?"?"+n:""}}class rc extends On{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const n=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let o=0;this._polling&&(o++,this.once("pollComplete",function(){--o||n()})),this.writable||(o++,this.once("drain",function(){--o||n()}))}else n()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){const n=o=>{if(this.readyState==="opening"&&o.type==="open"&&this.onOpen(),o.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(o)};Wl(e,this.socket.binaryType).forEach(n),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};this.readyState==="open"?e():this.once("open",e)}write(e){this.writable=!1,Ul(e,n=>{this.doWrite(n,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",n=this.query||{};return this.opts.timestampRequests!==!1&&(n[this.opts.timestampParam]=ir()),!this.supportsBinary&&!n.sid&&(n.b64=1),this.createUri(e,n)}}let sr=!1;try{sr=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const ic=sr;function sc(){}class ac extends rc{constructor(e){if(super(e),typeof location<"u"){const n=location.protocol==="https:";let o=location.port;o||(o=n?"443":"80"),this.xd=typeof location<"u"&&e.hostname!==location.hostname||o!==e.port}}doWrite(e,n){const o=this.request({method:"POST",data:e});o.on("success",n),o.on("error",(r,s)=>{this.onError("xhr post error",r,s)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(n,o)=>{this.onError("xhr poll error",n,o)}),this.pollXhr=e}}class _e extends ue{constructor(e,n,o){super(),this.createRequest=e,Ht(this,o),this._opts=o,this._method=o.method||"GET",this._uri=n,this._data=o.data!==void 0?o.data:null,this._create()}_create(){var e;const n=rr(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;const o=this._xhr=this.createRequest(n);try{o.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){o.setDisableHeaderCheck&&o.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&o.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{o.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{o.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(o),"withCredentials"in o&&(o.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(o.timeout=this._opts.requestTimeout),o.onreadystatechange=()=>{var r;o.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(o.getResponseHeader("set-cookie"))),o.readyState===4&&(o.status===200||o.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof o.status=="number"?o.status:0)},0))},o.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=_e.requestsCount++,_e.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=sc,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete _e.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}_e.requestsCount=0;_e.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",lo);else if(typeof addEventListener=="function"){const t="onpagehide"in we?"pagehide":"unload";addEventListener(t,lo,!1)}}function lo(){for(let t in _e.requests)_e.requests.hasOwnProperty(t)&&_e.requests[t].abort()}const lc=(function(){const t=ar({xdomain:!1});return t&&t.responseType!==null})();class cc extends ac{constructor(e){super(e);const n=e&&e.forceBase64;this.supportsBinary=lc&&!n}request(e={}){return Object.assign(e,{xd:this.xd},this.opts),new _e(ar,this.uri(),e)}}function ar(t){const e=t.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!e||ic))return new XMLHttpRequest}catch{}if(!e)try{return new we[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const lr=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class uc extends On{get name(){return"websocket"}doOpen(){const e=this.uri(),n=this.opts.protocols,o=lr?{}:rr(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(o.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,n,o)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const o=e[n],r=n===e.length-1;En(o,this.supportsBinary,s=>{try{this.doWrite(o,s)}catch{}r&&Dt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=ir()),this.supportsBinary||(n.b64=1),this.createUri(e,n)}}const nn=we.WebSocket||we.MozWebSocket;class dc extends uc{createSocket(e,n,o){return lr?new nn(e,n,o):n?new nn(e,n):new nn(e)}doWrite(e,n){this.ws.send(n)}}class fc extends On{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(e){return this.emitReserved("error",e)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const n=Xl(Number.MAX_SAFE_INTEGER,this.socket.binaryType),o=e.readable.pipeThrough(n).getReader(),r=ql();r.readable.pipeTo(e.writable),this._writer=r.writable.getWriter();const s=()=>{o.read().then(({done:c,value:l})=>{c||(this.onPacket(l),s())}).catch(c=>{})};s();const a={type:"open"};this.query.sid&&(a.data=`{"sid":"${this.query.sid}"}`),this._writer.write(a).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let n=0;n<e.length;n++){const o=e[n],r=n===e.length-1;this._writer.write(o).then(()=>{r&&Dt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;(e=this._transport)===null||e===void 0||e.close()}}const mc={websocket:dc,webtransport:fc,polling:cc},pc=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,hc=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function un(t){if(t.length>8e3)throw"URI too long";const e=t,n=t.indexOf("["),o=t.indexOf("]");n!=-1&&o!=-1&&(t=t.substring(0,n)+t.substring(n,o).replace(/:/g,";")+t.substring(o,t.length));let r=pc.exec(t||""),s={},a=14;for(;a--;)s[hc[a]]=r[a]||"";return n!=-1&&o!=-1&&(s.source=e,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s.pathNames=gc(s,s.path),s.queryKey=vc(s,s.query),s}function gc(t,e){const n=/\/{2,9}/g,o=e.replace(n,"/").split("/");return(e.slice(0,1)=="/"||e.length===0)&&o.splice(0,1),e.slice(-1)=="/"&&o.splice(o.length-1,1),o}function vc(t,e){const n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(o,r,s){r&&(n[r]=s)}),n}const dn=typeof addEventListener=="function"&&typeof removeEventListener=="function",wt=[];dn&&addEventListener("offline",()=>{wt.forEach(t=>t())},!1);class ze extends ue{constructor(e,n){if(super(),this.binaryType=Gl,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(n=e,e=null),e){const o=un(e);n.hostname=o.host,n.secure=o.protocol==="https"||o.protocol==="wss",n.port=o.port,o.query&&(n.query=o.query)}else n.host&&(n.hostname=un(n.host).host);Ht(this,n),this.secure=n.secure!=null?n.secure:typeof location<"u"&&location.protocol==="https:",n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=n.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(o=>{const r=o.prototype.name;this.transports.push(r),this._transportsByName[r]=o}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=nc(this.opts.query)),dn&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},wt.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const n=Object.assign({},this.opts.query);n.EIO=or,n.transport=e,this.id&&(n.sid=this.id);const o=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](o)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const e=this.opts.rememberUpgrade&&ze.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const n=this.createTransport(e);n.open(),this.setTransport(n)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",n=>this._onClose("transport close",n))}onOpen(){this.readyState="open",ze.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const n=new Error("server error");n.code=e.data,this._onError(n);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let n=1;for(let o=0;o<this.writeBuffer.length;o++){const r=this.writeBuffer[o].data;if(r&&(n+=Jl(r)),o>0&&n>this._maxPayload)return this.writeBuffer.slice(0,o);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,Dt(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,n,o){return this._sendPacket("message",e,n,o),this}send(e,n,o){return this._sendPacket("message",e,n,o),this}_sendPacket(e,n,o,r){if(typeof n=="function"&&(r=n,n=void 0),typeof o=="function"&&(r=o,o=null),this.readyState==="closing"||this.readyState==="closed")return;o=o||{},o.compress=o.compress!==!1;const s={type:e,data:n,options:o};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),r&&this.once("flush",r),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},n=()=>{this.off("upgrade",n),this.off("upgradeError",n),e()},o=()=>{this.once("upgrade",n),this.once("upgradeError",n)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?o():e()}):this.upgrading?o():e()),this}_onError(e){if(ze.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,n){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),dn&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const o=wt.indexOf(this._offlineEventListener);o!==-1&&wt.splice(o,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,n),this.writeBuffer=[],this._prevBufferLen=0}}}ze.protocol=or;class yc extends ze{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let n=this.createTransport(e),o=!1;ze.priorWebsocketSuccess=!1;const r=()=>{o||(n.send([{type:"ping",data:"probe"}]),n.once("packet",u=>{if(!o)if(u.type==="pong"&&u.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",n),!n)return;ze.priorWebsocketSuccess=n.name==="websocket",this.transport.pause(()=>{o||this.readyState!=="closed"&&(f(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())})}else{const m=new Error("probe error");m.transport=n.name,this.emitReserved("upgradeError",m)}}))};function s(){o||(o=!0,f(),n.close(),n=null)}const a=u=>{const m=new Error("probe error: "+u);m.transport=n.name,s(),this.emitReserved("upgradeError",m)};function c(){a("transport closed")}function l(){a("socket closed")}function d(u){n&&u.name!==n.name&&s()}const f=()=>{n.removeListener("open",r),n.removeListener("error",a),n.removeListener("close",c),this.off("close",l),this.off("upgrading",d)};n.once("open",r),n.once("error",a),n.once("close",c),this.once("close",l),this.once("upgrading",d),this._upgrades.indexOf("webtransport")!==-1&&e!=="webtransport"?this.setTimeoutFn(()=>{o||n.open()},200):n.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const n=[];for(let o=0;o<e.length;o++)~this.transports.indexOf(e[o])&&n.push(e[o]);return n}}let bc=class extends yc{constructor(e,n={}){const o=typeof e=="object"?e:n;(!o.transports||o.transports&&typeof o.transports[0]=="string")&&(o.transports=(o.transports||["polling","websocket","webtransport"]).map(r=>mc[r]).filter(r=>!!r)),super(e,o)}};function xc(t,e="",n){let o=t;n=n||typeof location<"u"&&location,t==null&&(t=n.protocol+"//"+n.host),typeof t=="string"&&(t.charAt(0)==="/"&&(t.charAt(1)==="/"?t=n.protocol+t:t=n.host+t),/^(https?|wss?):\/\//.test(t)||(typeof n<"u"?t=n.protocol+"//"+t:t="https://"+t),o=un(t)),o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443")),o.path=o.path||"/";const s=o.host.indexOf(":")!==-1?"["+o.host+"]":o.host;return o.id=o.protocol+"://"+s+":"+o.port+e,o.href=o.protocol+"://"+s+(n&&n.port===o.port?"":":"+o.port),o}const wc=typeof ArrayBuffer=="function",Cc=t=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,cr=Object.prototype.toString,Sc=typeof Blob=="function"||typeof Blob<"u"&&cr.call(Blob)==="[object BlobConstructor]",Ec=typeof File=="function"||typeof File<"u"&&cr.call(File)==="[object FileConstructor]";function In(t){return wc&&(t instanceof ArrayBuffer||Cc(t))||Sc&&t instanceof Blob||Ec&&t instanceof File}function Ct(t,e){if(!t||typeof t!="object")return!1;if(Array.isArray(t)){for(let n=0,o=t.length;n<o;n++)if(Ct(t[n]))return!0;return!1}if(In(t))return!0;if(t.toJSON&&typeof t.toJSON=="function"&&arguments.length===1)return Ct(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&Ct(t[n]))return!0;return!1}function $c(t){const e=[],n=t.data,o=t;return o.data=fn(n,e),o.attachments=e.length,{packet:o,buffers:e}}function fn(t,e){if(!t)return t;if(In(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}else if(Array.isArray(t)){const n=new Array(t.length);for(let o=0;o<t.length;o++)n[o]=fn(t[o],e);return n}else if(typeof t=="object"&&!(t instanceof Date)){const n={};for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=fn(t[o],e));return n}return t}function Oc(t,e){return t.data=mn(t.data,e),delete t.attachments,t}function mn(t,e){if(!t)return t;if(t&&t._placeholder===!0){if(typeof t.num=="number"&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}else if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=mn(t[n],e);else if(typeof t=="object")for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=mn(t[n],e));return t}const Ic=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Tc=5;var W;(function(t){t[t.CONNECT=0]="CONNECT",t[t.DISCONNECT=1]="DISCONNECT",t[t.EVENT=2]="EVENT",t[t.ACK=3]="ACK",t[t.CONNECT_ERROR=4]="CONNECT_ERROR",t[t.BINARY_EVENT=5]="BINARY_EVENT",t[t.BINARY_ACK=6]="BINARY_ACK"})(W||(W={}));class Rc{constructor(e){this.replacer=e}encode(e){return(e.type===W.EVENT||e.type===W.ACK)&&Ct(e)?this.encodeAsBinary({type:e.type===W.EVENT?W.BINARY_EVENT:W.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id}):[this.encodeAsString(e)]}encodeAsString(e){let n=""+e.type;return(e.type===W.BINARY_EVENT||e.type===W.BINARY_ACK)&&(n+=e.attachments+"-"),e.nsp&&e.nsp!=="/"&&(n+=e.nsp+","),e.id!=null&&(n+=e.id),e.data!=null&&(n+=JSON.stringify(e.data,this.replacer)),n}encodeAsBinary(e){const n=$c(e),o=this.encodeAsString(n.packet),r=n.buffers;return r.unshift(o),r}}function co(t){return Object.prototype.toString.call(t)==="[object Object]"}class Tn extends ue{constructor(e){super(),this.reviver=e}add(e){let n;if(typeof e=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");n=this.decodeString(e);const o=n.type===W.BINARY_EVENT;o||n.type===W.BINARY_ACK?(n.type=o?W.EVENT:W.ACK,this.reconstructor=new _c(n),n.attachments===0&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(In(e)||e.base64)if(this.reconstructor)n=this.reconstructor.takeBinaryData(e),n&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+e)}decodeString(e){let n=0;const o={type:Number(e.charAt(0))};if(W[o.type]===void 0)throw new Error("unknown packet type "+o.type);if(o.type===W.BINARY_EVENT||o.type===W.BINARY_ACK){const s=n+1;for(;e.charAt(++n)!=="-"&&n!=e.length;);const a=e.substring(s,n);if(a!=Number(a)||e.charAt(n)!=="-")throw new Error("Illegal attachments");o.attachments=Number(a)}if(e.charAt(n+1)==="/"){const s=n+1;for(;++n&&!(e.charAt(n)===","||n===e.length););o.nsp=e.substring(s,n)}else o.nsp="/";const r=e.charAt(n+1);if(r!==""&&Number(r)==r){const s=n+1;for(;++n;){const a=e.charAt(n);if(a==null||Number(a)!=a){--n;break}if(n===e.length)break}o.id=Number(e.substring(s,n+1))}if(e.charAt(++n)){const s=this.tryParse(e.substr(n));if(Tn.isPayloadValid(o.type,s))o.data=s;else throw new Error("invalid payload")}return o}tryParse(e){try{return JSON.parse(e,this.reviver)}catch{return!1}}static isPayloadValid(e,n){switch(e){case W.CONNECT:return co(n);case W.DISCONNECT:return n===void 0;case W.CONNECT_ERROR:return typeof n=="string"||co(n);case W.EVENT:case W.BINARY_EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&Ic.indexOf(n[0])===-1);case W.ACK:case W.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class _c{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const n=Oc(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Nc=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Tn,Encoder:Rc,get PacketType(){return W},protocol:Tc},Symbol.toStringTag,{value:"Module"}));function Oe(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const Mc=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class ur extends ue{constructor(e,n,o){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=n,o&&o.auth&&(this.auth=o.auth),this._opts=Object.assign({},o),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[Oe(e,"open",this.onopen.bind(this)),Oe(e,"packet",this.onpacket.bind(this)),Oe(e,"error",this.onerror.bind(this)),Oe(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...n){var o,r,s;if(Mc.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');if(n.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;const a={type:W.EVENT,data:n};if(a.options={},a.options.compress=this.flags.compress!==!1,typeof n[n.length-1]=="function"){const f=this.ids++,u=n.pop();this._registerAckCallback(f,u),a.id=f}const c=(r=(o=this.io.engine)===null||o===void 0?void 0:o.transport)===null||r===void 0?void 0:r.writable,l=this.connected&&!(!((s=this.io.engine)===null||s===void 0)&&s._hasPingExpired());return this.flags.volatile&&!c||(l?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}_registerAckCallback(e,n){var o;const r=(o=this.flags.timeout)!==null&&o!==void 0?o:this._opts.ackTimeout;if(r===void 0){this.acks[e]=n;return}const s=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let c=0;c<this.sendBuffer.length;c++)this.sendBuffer[c].id===e&&this.sendBuffer.splice(c,1);n.call(this,new Error("operation has timed out"))},r),a=(...c)=>{this.io.clearTimeoutFn(s),n.apply(this,c)};a.withError=!0,this.acks[e]=a}emitWithAck(e,...n){return new Promise((o,r)=>{const s=(a,c)=>a?r(a):o(c);s.withError=!0,n.push(s),this.emit(e,...n)})}_addToQueue(e){let n;typeof e[e.length-1]=="function"&&(n=e.pop());const o={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((r,...s)=>o!==this._queue[0]?void 0:(r!==null?o.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(r)):(this._queue.shift(),n&&n(null,...s)),o.pending=!1,this._drainQueue())),this._queue.push(o),this._drainQueue()}_drainQueue(e=!1){if(!this.connected||this._queue.length===0)return;const n=this._queue[0];n.pending&&!e||(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){typeof this.auth=="function"?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:W.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(o=>String(o.id)===e)){const o=this.acks[e];delete this.acks[e],o.withError&&o.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case W.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case W.EVENT:case W.BINARY_EVENT:this.onevent(e);break;case W.ACK:case W.BINARY_ACK:this.onack(e);break;case W.DISCONNECT:this.ondisconnect();break;case W.CONNECT_ERROR:this.destroy();const o=new Error(e.data.message);o.data=e.data.data,this.emitReserved("connect_error",o);break}}onevent(e){const n=e.data||[];e.id!=null&&n.push(this.ack(e.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const n=this._anyListeners.slice();for(const o of n)o.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&typeof e[e.length-1]=="string"&&(this._lastOffset=e[e.length-1])}ack(e){const n=this;let o=!1;return function(...r){o||(o=!0,n.packet({type:W.ACK,id:e,data:r}))}}onack(e){const n=this.acks[e.id];typeof n=="function"&&(delete this.acks[e.id],n.withError&&e.data.unshift(null),n.apply(this,e.data))}onconnect(e,n){this.id=e,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:W.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const n=this._anyListeners;for(let o=0;o<n.length;o++)if(e===n[o])return n.splice(o,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const n=this._anyOutgoingListeners;for(let o=0;o<n.length;o++)if(e===n[o])return n.splice(o,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const n=this._anyOutgoingListeners.slice();for(const o of n)o.apply(this,e.data)}}}function tt(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}tt.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=(Math.floor(e*10)&1)==0?t-n:t+n}return Math.min(t,this.max)|0};tt.prototype.reset=function(){this.attempts=0};tt.prototype.setMin=function(t){this.ms=t};tt.prototype.setMax=function(t){this.max=t};tt.prototype.setJitter=function(t){this.jitter=t};class pn extends ue{constructor(e,n){var o;super(),this.nsps={},this.subs=[],e&&typeof e=="object"&&(n=e,e=void 0),n=n||{},n.path=n.path||"/socket.io",this.opts=n,Ht(this,n),this.reconnection(n.reconnection!==!1),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor((o=n.randomizationFactor)!==null&&o!==void 0?o:.5),this.backoff=new tt({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(n.timeout==null?2e4:n.timeout),this._readyState="closed",this.uri=e;const r=n.parser||Nc;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=n.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return e===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var n;return e===void 0?this._reconnectionDelay:(this._reconnectionDelay=e,(n=this.backoff)===null||n===void 0||n.setMin(e),this)}randomizationFactor(e){var n;return e===void 0?this._randomizationFactor:(this._randomizationFactor=e,(n=this.backoff)===null||n===void 0||n.setJitter(e),this)}reconnectionDelayMax(e){var n;return e===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,(n=this.backoff)===null||n===void 0||n.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new bc(this.uri,this.opts);const n=this.engine,o=this;this._readyState="opening",this.skipReconnect=!1;const r=Oe(n,"open",function(){o.onopen(),e&&e()}),s=c=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",c),e?e(c):this.maybeReconnectOnOpen()},a=Oe(n,"error",s);if(this._timeout!==!1){const c=this._timeout,l=this.setTimeoutFn(()=>{r(),s(new Error("timeout")),n.close()},c);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(r),this.subs.push(a),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(Oe(e,"ping",this.onping.bind(this)),Oe(e,"data",this.ondata.bind(this)),Oe(e,"error",this.onerror.bind(this)),Oe(e,"close",this.onclose.bind(this)),Oe(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(n){this.onclose("parse error",n)}}ondecoded(e){Dt(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,n){let o=this.nsps[e];return o?this._autoConnect&&!o.active&&o.connect():(o=new ur(this,e,n),this.nsps[e]=o),o}_destroy(e){const n=Object.keys(this.nsps);for(const o of n)if(this.nsps[o].active)return;this._close()}_packet(e){const n=this.encoder.encode(e);for(let o=0;o<n.length;o++)this.engine.write(n[o],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,n){var o;this.cleanup(),(o=this.engine)===null||o===void 0||o.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const n=this.backoff.duration();this._reconnecting=!0;const o=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),!e.skipReconnect&&e.open(r=>{r?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",r)):e.onreconnect()}))},n);this.opts.autoUnref&&o.unref(),this.subs.push(()=>{this.clearTimeoutFn(o)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const it={};function St(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};const n=xc(t,e.path||"/socket.io"),o=n.source,r=n.id,s=n.path,a=it[r]&&s in it[r].nsps,c=e.forceNew||e["force new connection"]||e.multiplex===!1||a;let l;return c?l=new pn(o,e):(it[r]||(it[r]=new pn(o,e)),l=it[r]),n.query&&!e.query&&(e.query=n.queryKey),l.socket(n.path,e)}Object.assign(St,{Manager:pn,Socket:ur,io:St,connect:St});const Pc="https://api.silent-talk.online",Bc="/socket.io";let me=null;const kc=()=>{me=St(Pc,{autoConnect:!1,path:Bc,extraHeaders:{Authorization:`Bearer ${Nr()}`}})};class Rt{static toDomain(e){return{chat:void 0,updatedAt:e.updatedAt,type:e.type,id:e.id,text:e.text,createdAt:e.createdAt,medias:e.medias?.map(Rt.mediaToDomain)||[],replyTo:e.replyTo?Rt.toDomain(e.replyTo):void 0,replies:[],user:e.user?Mr.toDomain(e.user):void 0}}static mediaToDomain(e){return{id:e.id,type:e.type,url:e.url,createdAt:e.createdAt,updatedAt:e.updatedAt,message:void 0}}}const Ac=async(t,e)=>je({method:"POST",url:`/messages/${t}`,data:e}),jc=async(t,e)=>je({method:"DELETE",url:`/messages/${t}/${e}`}),Lc=async(t,e,n)=>je({method:"PATCH",url:`/messages/${t}/${e}`,data:{text:n}}),zc=async(t,e)=>{const n=await je({method:"GET",url:`/messages/${t}`,params:e});console.log("Raw response data: ",n);const o=n.data.map(Rt.toDomain);return console.log("Converted data: ",o),{...n,data:o}},Ft={sendMessage:Ac,deleteMessage:jc,editMessage:Lc,getAllMessages:zc},Dc=25,Hc=300,Fc=(t,e)=>{const n=Pr(),o=i.useMemo(()=>["chat-messages",t],[t]),{data:r,error:s,fetchNextPage:a,hasNextPage:c,isLoading:l,isError:d,isFetchingNextPage:f}=ul({queryKey:o,queryFn:async({pageParam:m})=>{const p=await Ft.getAllMessages(t,{page:m,limit:Dc});return console.log("Messages in queryFn:",p),p},initialPageParam:1,getNextPageParam:m=>m.currentPage<m.totalPages?m.currentPage+1:void 0,staleTime:1});console.log("Error in useChatMessages:",s),i.useEffect(()=>{if(!me||!t)return;me.connected||me.connect();const m=()=>{console.log(`[Socket] Emitting 'join_chat' for chatId: ${t}`),me&&me.emit("join_chat",t)};me.connected?m():me.on("connect",m);const p=x=>{n.setQueryData(o,$=>{if(!$)return $;const I=$.pages.map((S,y)=>y===0?{...S,data:[...S.data,x]}:S);return{...$,pages:I}}),(e&&"current"in e&&e.current?e.current.scrollHeight-e.current.scrollTop-e.current.clientHeight<Hc:!1)?setTimeout(()=>{e&&"current"in e&&e.current&&(e.current.scrollTop=e.current.scrollHeight)},250):Se("Пришло новое сообщение","info")},h=x=>{n.setQueryData(o,v=>{if(!v)return v;const $=v.pages.map(I=>({...I,data:I.data.map(S=>S.id===x.id?x:S)}));return{...v,pages:$}})},g=x=>{n.setQueryData(o,v=>{if(!v)return v;const $=v.pages.map(I=>({...I,data:I.data.filter(S=>S.id!==x)}));return{...v,pages:$}})};return me.on("new_message",p),me.on("message_updated",h),me.on("message_deleted",g),()=>{me&&(me.off("new_message",p),me.off("message_updated",h),me.off("message_deleted",g),me.emit("leave_chat",t),me.off("connect",m))}},[t,n,o,e]),i.useLayoutEffect(()=>{kc()},[]),console.log("Data pages in useChatMessages:",r?.pages);const u=i.useMemo(()=>r?.pages?r.pages.slice().reverse().flatMap(m=>m.data):[],[r]);return console.log("useChatMessages messages",u),{messages:u,isLoading:l,isError:d,error:s,fetchNextPage:a,hasNextPage:c,isFetchingNextPage:f}},Vc=({afterSuccess:t=Ze,afterError:e=Ze,showSuccessNotification:n=!0,showErrorNotification:o=!1,chatId:r=""})=>{const{error:s,isPending:a,mutateAsync:c,isError:l}=kt({mutationFn:async d=>await Ft.deleteMessage(r,d),onSuccess:async()=>{n&&Se("Сообщение успешно удалено!","success"),t&&t()},onError:async d=>{o&&Se(d.message,"error"),e&&e()}});return{loading:a,deleteMessage:c,error:l?s?.message:[]}},Uc=yn({type:bo(Ce),url:bn({message:"URL медиафайла должен быть валидным."})}),Wc=yn({type:bo(Qe),text:bn().min(0,{message:"Текст сообщения не может быть пустым."}).max(2e3,{message:"Текст сообщения не должен превышать 2000 символов."}).optional(),replyToId:yi({message:"ID сообщения для ответа должен быть в формате UUID."}).optional(),medias:vi(Uc).optional()}).superRefine((t,e)=>{const n=!!t.text&&t.text.trim().length>0,o=!!t.medias&&t.medias.length>0;!n&&!o&&e.addIssue({code:"custom",message:"Сообщение должно содержать либо текст, либо медиафайлы.",path:["text"]})}),qc=({afterSuccess:t=Ze,afterError:e=Ze,showSuccessNotification:n=!0,showErrorNotification:o=!1,clearForm:r=!1,chatId:s="",chatRef:a})=>{const[c,l]=i.useState(null),{error:d,isPending:f,mutateAsync:u,isError:m}=kt({mutationFn:async g=>await Ft.sendMessage(s,g),onSuccess:async()=>{n&&Se("Сообщение успешно отправлено!","success"),t&&t()},onError:async g=>{o&&Se(g.message,"error"),e&&e()}}),p=xo({mode:"all",reValidateMode:"onChange",resolver:wo(Wc)}),h=p.handleSubmit(async g=>{a&&typeof a!="function"&&a.current&&a.current.scrollTo(0,a.current.scrollHeight),console.log("Triggered",g),await u({...g,replyToId:c?.id}),r&&p.reset(),l(null)});return{form:p,loading:f,sendMessage:h,error:m?d?.message:[],replyMessage:c,setReplyMessage:l,sendMessageMutation:u}},Xc=yn({text:bn().min(1,{message:"Текст сообщения не может быть пустым."}).max(2e3,{message:"Текст сообщения не должен превышать 2000 символов."})}),Yc=({afterSuccess:t=Ze,afterError:e=Ze,showSuccessNotification:n=!0,showErrorNotification:o=!1,clearForm:r=!1,chatId:s=""})=>{const[a,c]=i.useState(null),{error:l,isPending:d,mutateAsync:f,isError:u}=kt({mutationFn:async h=>await Ft.editMessage(s,a?.id||"",h.text),onSuccess:async()=>{n&&Se("Сообщение успешно обновлено!","success"),t&&t()},onError:async h=>{o&&Se(h.message,"error"),e&&e()}}),m=xo({mode:"all",reValidateMode:"onChange",resolver:wo(Xc)}),p=m.handleSubmit(async h=>{a&&(await f(h),r&&m.reset(),c(null))});return{form:m,loading:d,updateMessage:p,error:u?l?.message:[],editMessage:a,setEditMessage:c}},Gc=async t=>je({data:t,headers:{"Content-Type":"multipart/form-data"},method:"POST",url:"/upload/video"}),Kc=async t=>je({data:t,headers:{"Content-Type":"multipart/form-data"},method:"POST",url:"/upload/photo"}),Zc=async t=>je({data:t,headers:{"Content-Type":"multipart/form-data"},method:"POST",url:"/upload/document"}),Qc=async t=>je({data:t,headers:{"Content-Type":"multipart/form-data"},method:"POST",url:"/upload/audio"}),Jc=async t=>je({data:t,headers:{"Content-Type":"multipart/form-data"},method:"POST",url:"/upload/voice"}),st={uploadVideo:Gc,uploadPhoto:Kc,uploadDocument:Zc,uploadAudio:Qc,uploadVoice:Jc},on={photo:{uploadFn:st.uploadPhoto,formDataKey:"photo"},video:{uploadFn:st.uploadVideo,formDataKey:"video"},document:{uploadFn:st.uploadDocument,formDataKey:"document"},audio:{uploadFn:st.uploadAudio,formDataKey:"audio"},voice:{uploadFn:st.uploadVoice,formDataKey:"voice"}},dr=()=>{const{isPending:t,mutateAsync:e,error:n}=kt({mutationFn:({type:s,fileFormData:a})=>{const{uploadFn:c}=on[s];return c(a)},onError:s=>{Se(s.message,"error")}}),o=i.useCallback(async(s,a,c)=>{const{formDataKey:l}=on[s],d=new FormData;d.append(l,a);try{const f=await e({type:s,fileFormData:d});return c&&c(f.url),f.url}catch(f){console.error("Upload failed:",f),Se("Upload failed. Please try again.","error");return}},[e]),r=i.useCallback(async(s,a,c)=>{const{formDataKey:l}=on[s],d=[];try{for(const u of a){const m=new FormData;m.append(l,u);const p=await e({type:s,fileFormData:m});d.push(p.url)}const f=d.join(",");return c&&c(f),f}catch(f){Se("One or more uploads failed. Please try again.","error"),console.error("Multiple upload failed:",f);return}},[e]);return{isLoading:t,error:n?.message??null,handleUpload:o,handleMultipleUpload:r}},eu=({createNewMessage:t})=>{const{handleUpload:e,isLoading:n}=dr(),[o,r]=i.useState(!1),[s,a]=i.useState(0),c=i.useRef(null);i.useEffect(()=>(o?c.current=setInterval(()=>{a(h=>h+1)},1e3):a(0),()=>{c.current&&clearInterval(c.current)}),[o]);const l=i.useRef(null),d=i.useRef([]),f=i.useCallback(async()=>{if(d.current.length===0)return;const h=new Blob(d.current,{type:"audio/webm"}),g=new File([h],"voice-message.webm",{type:"audio/webm"});d.current=[];try{const x=await e("voice",g);x?t({type:Qe.VOICE,medias:[{type:Ce.VOICE,url:x}]}):Se("Failed to upload voice message. Please try again.","error")}catch(x){console.error("Error during voice message upload:",x)}},[e,t]),u=i.useCallback(async()=>{try{const h=await navigator.mediaDevices.getUserMedia({audio:!0});r(!0);const g=new MediaRecorder(h);l.current=g,d.current=[],g.start(),g.ondataavailable=x=>{x.data.size>0&&d.current.push(x.data)},g.onstop=f}catch(h){Se("Microphone access was denied.","error"),r(!1),console.log("Error accessing microphone:",h)}},[f]),m=i.useCallback(()=>{l.current&&o&&(l.current.stop(),l.current.stream.getTracks().forEach(h=>h.stop()),r(!1))},[o]),p=i.useCallback(()=>{l.current&&o&&(l.current.onstop=null,l.current.stop(),l.current.stream.getTracks().forEach(h=>h.stop()),r(!1),d.current=[])},[o]);return{isRecording:o,isUploading:n,startRecording:u,stopRecording:m,cancelRecording:p,recordingTimer:s}},tu=({ref:t,threshold:e=100})=>{const[n,o]=i.useState(!1);i.useEffect(()=>{if(!t||!("current"in t)||!t.current)return;const s=()=>{if(!t.current)return;const{scrollTop:c,scrollHeight:l,clientHeight:d}=t.current;o(l-c-d<=e)},a=t.current;return a.addEventListener("scroll",s),s(),()=>{a.removeEventListener("scroll",s)}},[t,e]);const r=i.useCallback(()=>{t&&"current"in t&&t.current&&(t.current.scrollTop=t.current.scrollHeight)},[t]);return{isAtBottom:n,scrollToBottom:r}},nu=({children:t,clearForm:e,showErrorNotification:n,showSuccessNotification:o,afterError:r,afterSuccess:s,chatId:a=""})=>{const[c,l]=i.useState("default"),d=i.useRef(null),{isAtBottom:f}=tu({ref:d,threshold:300}),{messages:u,isFetchingNextPage:m,hasNextPage:p,fetchNextPage:h}=Fc(a,d),{loading:g,form:x,sendMessage:v,setReplyMessage:$,replyMessage:I,sendMessageMutation:S}=qc({chatId:a,clearForm:e,showErrorNotification:n,showSuccessNotification:o,afterError:r,afterSuccess:s,chatRef:d}),{loading:y,form:_,updateMessage:w,setEditMessage:C,editMessage:O}=Yc({chatId:a,clearForm:e,showErrorNotification:n,showSuccessNotification:o,afterError:r,afterSuccess:s}),{loading:T,deleteMessage:R}=Vc({chatId:a,showErrorNotification:n,showSuccessNotification:o,afterError:r,afterSuccess:s}),{handleMultipleUpload:P,isLoading:M}=dr(),{startRecording:E,stopRecording:N,recordingTimer:A,isUploading:B,cancelRecording:k}=eu({createNewMessage:S}),D=i.useCallback(X=>{C(X),l(X?"edit":"default")},[C]),q=i.useCallback(()=>{D(null)},[D]),G=i.useCallback(()=>{E(),l("voice")},[E]),K=i.useCallback(()=>{N(),l("default")},[N]),L=i.useCallback(()=>{k(),l("default")},[k]),J=i.useMemo(()=>{const oe={mutationLoading:g||y||M||B||T,chatRef:d,handleDeleteMessage:R,handleMultipleUpload:P,replyToMessage:I,setReplyToMessage:$,setEditMessage:D,startRecording:G};return c==="edit"&&O?{...oe,mode:"edit",isRecording:!1,editMessage:O,chatForm:_,handleSubmit:w,cancelEdit:q}:c==="voice"?{...oe,mode:"voice",isRecording:!0,editMessage:null,recordingTimer:A,stopRecording:K,cancelRecording:L}:{...oe,mode:"default",isRecording:!1,editMessage:null,chatForm:x,handleSubmit:v}},[c,g,y,M,B,T,R,P,I,$,O,_,w,K,L,D,G,q,A,x,v]),Z=i.useMemo(()=>({loading:m,chatRef:d,setReplyToMessage:$,setEditMessage:D,messages:u,mutationLoading:g||y||M||B||T,handleDeleteMessage:R,isAtBottom:f,isFetchingMore:m,hasMore:p,fetchMoreMessages:h,error:null}),[m,d,$,D,u,g,y,M,B,T,R,f,p,h]);return console.log("Messages in Chat Widget:",u),b.jsx(yl,{value:Z,children:b.jsx(Bl,{value:J,children:t})})},ou=i.memo(nu),ru=({children:t})=>{const{loading:e,refetch:n,me:o,error:r}=Br();return b.jsx(bl,{error:r,loading:e,me:o,refetch:n,children:t})},iu=i.memo(ru),{Content:su}=ke,au=()=>{const e=kr().chatId||"";return b.jsx("main",{children:b.jsxs(ke,{className:"h-[100dvh]",children:[b.jsx(vl,{chatId:e}),b.jsx(ke,{children:b.jsx(su,{className:"flex flex-col",children:b.jsx(iu,{children:b.jsxs(ou,{clearForm:!0,chatId:e,showErrorNotification:!0,showSuccessNotification:!1,children:[b.jsx(Pl,{}),b.jsx(zl,{})]})})})})]})})},fu=i.memo(au);export{fu as default};
