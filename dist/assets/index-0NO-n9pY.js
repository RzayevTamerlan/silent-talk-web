import{r as i,t as y,L as e,P as N,U as b}from"./index-Cca-xBjx.js";import{I as z,a1 as C,a2 as x,a3 as u,B as I,a4 as M,ac as F,a6 as h,a7 as P,a8 as S,a9 as E,aa as p,ab as f}from"./d-func-Dc-bNQ09.js";import{C as A,F as m,R as U}from"./UserOutlined-CcHhR8Yu.js";import{R as V,a as $}from"./index-B2lXdx0D.js";var L={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"}}]},name:"mail",theme:"outlined"},B=function(a,r){return i.createElement(z,y({},a,{ref:r,icon:L}))},O=i.forwardRef(B);const j=i.createContext(null),Z=i.memo(({children:s,...a})=>e.jsx(j.Provider,{value:a,children:s})),_=()=>{const s=i.useContext(j);if(!s)throw new Error("useRegisterContract must be used within a RegisterContractProvider");return s},q=({useContract:s=_})=>{const{signUp:a,loading:r,error:o,form:c}=s(),{control:n,formState:{errors:t}}=c;return e.jsx(A,{className:"w-full max-w-md",title:"Регистрация аккаунта",children:e.jsxs(m,{layout:"vertical",onFinish:a,className:"space-y-4",children:[o&&o.length>0&&e.jsx(C,{message:"Ошибка",description:o,type:"error",showIcon:!0,closable:!0,className:"mb-4"}),e.jsx(m.Item,{label:"Имя пользователя",validateStatus:t.username?"error":"",help:t.username?.message,required:!0,children:e.jsx(x,{name:"username",control:n,render:({field:l})=>e.jsx(u,{...l,size:"large",prefix:e.jsx(U,{className:"text-gray-300"}),placeholder:"Придумайте имя пользователя"})})}),e.jsx(m.Item,{label:"Пароль",validateStatus:t.password?"error":"",help:t.password?.message,required:!0,children:e.jsx(x,{name:"password",control:n,render:({field:l})=>e.jsx(u.Password,{...l,size:"large",prefix:e.jsx(V,{className:"text-gray-300"}),placeholder:"Придумайте пароль"})})}),e.jsx(m.Item,{label:"Email (необязательно)",validateStatus:t.email?"error":"",help:t.email?.message,children:e.jsx(x,{name:"email",control:n,render:({field:l})=>e.jsx(u,{...l,size:"large",prefix:e.jsx(O,{className:"text-gray-300"}),placeholder:"Введите email (необязательно)"})})}),e.jsx(m.Item,{children:e.jsx(I,{type:"primary",htmlType:"submit",size:"large",loading:r,className:"w-full",children:r?"Регистрация...":"Зарегистрироваться"})})]})})},H=i.memo(q),T=M({username:h("Введите имя пользователя").min(3,"Имя пользователя должно содержать минимум 3 символа").max(50,"Имя пользователя должно содержать максимум 50 символов").regex(/^[a-zA-Z][a-zA-Z0-9_.-]*$/,{message:"Имя пользователя должно начинаться с буквы и может содержать только буквы, цифры, точки, подчеркивания и дефисы"}),password:h("Введите пароль").min(8,"Пароль должен содержать минимум 8 символов").max(50,"Пароль должен содержать максимум 50 символов").regex(/(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*()_+\-=\]{};':"\\|,.<>?])/,{message:"Пароль должен содержать одну цифру, одну строчную букву, одну заглавную букву и один специальный символ"}),email:F("Некорректный формат email").optional()}),W=({afterSuccess:s=p,afterError:a=p,redirectUrl:r="/",showSuccessNotification:o=!0,showErrorNotification:c=!1})=>{const n=N(),{error:t,isPending:l,mutateAsync:v,isError:w}=P({mutationFn:$.register,onSuccess:async()=>{o&&f("Вы успешно зарегестрировались! Теперь, пожалуйста, войдите в аккаунт.","success"),n(r),s&&s()},onError:async d=>{c&&f(d.message,"error"),a&&a()}}),g=S({mode:"all",reValidateMode:"onChange",resolver:E(T)}),R=g.handleSubmit(async d=>{await v(d)});return{form:g,loading:l,signUp:R,error:w?t?.message:[]}},k=({children:s,redirectUrl:a="/"})=>{const{loading:r,signUp:o,form:c,error:n}=W({redirectUrl:a,showSuccessNotification:!0,showErrorNotification:!0});return e.jsx(Z,{signUp:o,form:c,error:n,loading:r,children:s})},D=i.memo(k),G=()=>e.jsx("main",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-gray-800",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-4rem)]",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Создание аккаунта"}),e.jsx("p",{className:"text-gray-300",children:"Зарегистрируйтесь, чтобы получить доступ ко всем возможностям"})]}),e.jsx(D,{redirectUrl:"/login",children:e.jsx(H,{})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-gray-300",children:["Уже есть аккаунт?"," ",e.jsx(b,{to:"/login",className:"text-blue-400 hover:text-blue-300 font-medium transition-colors",children:"Войти"})]})})]})})})}),Y=i.memo(G);export{Y as default};
