import{r as i,S as e,Z as b,X as v,$ as L}from"./index-CDeMDPRH.js";import{a5 as C,a6 as g,a7 as u,B as I,a8 as z,aa as h,ab as F,ac as S,ad as P,ae as p,af as j}from"./d-func-Chl0-TIf.js";import{C as A,F as d,R}from"./UserOutlined-C4s30Inq.js";import{R as D,a as E}from"./index-CyNWFM1V.js";const f=i.createContext(null),M=i.memo(({children:s,...a})=>e.jsx(f.Provider,{value:a,children:s})),T=()=>{const s=i.useContext(f);if(!s)throw new Error("useLoginContract must be used within a LoginContractProvider");return s},k=({useContract:s=T})=>{const{signIn:a,loading:r,error:t,form:c}=s(),{control:o,formState:{errors:n}}=c;return e.jsx(A,{className:"w-full max-w-md",title:"Вход в аккаунт",children:e.jsxs(d,{layout:"vertical",onFinish:a,className:"space-y-4",children:[t&&t.length>0&&e.jsx(C,{message:"Ошибка",description:t,type:"error",showIcon:!0,closable:!0,className:"mb-4"}),e.jsx(d.Item,{label:"Имя пользователя",validateStatus:n.username?"error":"",help:n.username?.message,children:e.jsx(g,{name:"username",control:o,render:({field:m})=>e.jsx(u,{...m,size:"large",prefix:e.jsx(R,{className:"text-gray-300"}),placeholder:"Введите имя пользователя"})})}),e.jsx(d.Item,{label:"Пароль",validateStatus:n.password?"error":"",help:n.password?.message,children:e.jsx(g,{name:"password",control:o,render:({field:m})=>e.jsx(u.Password,{...m,size:"large",prefix:e.jsx(D,{className:"text-gray-300"}),placeholder:"Введите пароль"})})}),e.jsx(d.Item,{children:e.jsx(I,{type:"primary",htmlType:"submit",size:"large",loading:r,className:"w-full",children:r?"Вход...":"Войти"})})]})})},Z=i.memo(k),$=s=>{const r=new Date(Date.now()+864e5);b.set("accessToken",s,{expires:r,path:"/"})},B=z({username:h("Введите имя пользователя").min(3,"Имя пользователя должно содержать минимум 3 символа").max(50,"Имя пользователя должно содержать максимум 50 символов").regex(/^[a-zA-Z][a-zA-Z0-9_.-]*$/,{message:"Имя пользователя должно начинаться с буквы и может содержать только буквы, цифры, точки, подчеркивания и дефисы"}),password:h("Введите пароль").min(8,"Пароль должен содержать минимум 8 символов").max(50,"Пароль должен содержать максимум 50 символов").regex(/(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&*()_+\-=\]{};':"\\|,.<>?])/,{message:"Пароль должен содержать одну цифру, одну строчную букву, одну заглавную букву и один специальный символ"})}),V=({afterSuccess:s=p,afterError:a=p,redirectUrl:r="/",showSuccessNotification:t=!0,showErrorNotification:c=!1})=>{const o=v(),{error:n,isPending:m,mutateAsync:w,isError:y}=F({mutationFn:E.signIn,onSuccess:async l=>{$(l.accessToken),t&&j("Вы успешно вошли в аккаунт","success"),o(r),s&&s()},onError:async l=>{c&&j(l.message,"error"),a&&a()}}),x=S({mode:"all",reValidateMode:"onChange",resolver:P(B)}),N=x.handleSubmit(async l=>{await w(l)});return{form:x,loading:m,signIn:N,error:y?n?.message:[]}},W=({children:s,redirectUrl:a="/"})=>{const{loading:r,signIn:t,form:c,error:o}=V({redirectUrl:a,showSuccessNotification:!0,showErrorNotification:!0});return e.jsx(M,{signIn:t,form:c,error:o,loading:r,children:s})},_=i.memo(W),X=()=>e.jsx("main",{className:"min-h-screen bg-gradient-to-br from-gray-900 to-gray-800",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex flex-col items-center justify-center min-h-[calc(100vh-4rem)]",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Добро пожаловать"}),e.jsx("p",{className:"text-gray-300",children:"Войдите в свой аккаунт чтобы продолжить"})]}),e.jsx(_,{children:e.jsx(Z,{})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-gray-300",children:["Нет аккаунта?"," ",e.jsx(L,{to:"/register",className:"text-blue-400 hover:text-blue-300 font-medium transition-colors",children:"Зарегистрироваться"})]})})]})})})}),K=i.memo(X);export{K as default};
